<!DOCTYPE html>
<html lang="en" class="scroll-smooth">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>BharatBulletin - Your Local News & Community Hub</title>
    <meta name="description" content="Stay up-to-date with local news, events, and community information in your area. BharatBulletin is your hyperlocal digital hub for community news, events, classifieds, and important updates. Discover what's happening in your neighborhood across India.">
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
        tailwind.config = {
            darkMode: 'class',
            theme: {
                extend: {
                    colors: {
                        primary: {
                            50: '#eff6ff',
                            500: '#3b82f6',
                            600: '#2563eb',
                            700: '#1d4ed8',
                        }
                    }
                }
            }
        }
    </script>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <!-- Leaflet CSS and JS -->
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
    <!-- Google OAuth SDK -->
    <script src="https://accounts.google.com/gsi/client" async defer></script>
    
    <style>
        /* Custom map marker styles */
        .user-location-marker {
            background: transparent !important;
            border: none !important;
        }
        
        .event-marker, .announcement-marker, .weather-marker {
            background: transparent !important;
            border: none !important;
        }
        
        /* Map popup styles */
        .leaflet-popup-content-wrapper {
            border-radius: 12px !important;
            box-shadow: 0 10px 25px rgba(0,0,0,0.15) !important;
        }
        
        .leaflet-popup-content {
            margin: 0 !important;
            padding: 0 !important;
        }
        
        /* Map layer button active state */
        .map-layer-btn.active {
            background-color: #3b82f6 !important;
            color: white !important;
        }
        
        /* Dark mode map adjustments */
        .dark .leaflet-container {
            background-color: #1f2937;
        }
        
        .dark .leaflet-popup-content-wrapper {
            background-color: #374151;
            color: white;
        }
        
        /* User menu animations */
        .user-menu-enter {
            opacity: 0;
            transform: translateY(-10px);
        }
        
        .user-menu-enter-active {
            opacity: 1;
            transform: translateY(0);
            transition: opacity 0.2s, transform 0.2s;
        }
        
        /* Welcome notification animations */
        .welcome-notification {
            animation: slideInRight 0.3s ease-out;
        }
        
        @keyframes slideInRight {
            from {
                transform: translateX(100%);
                opacity: 0;
            }
            to {
                transform: translateX(0);
                opacity: 1;
            }
        }
    </style>
</head>
<body class="bg-gray-50 dark:bg-gray-900 text-gray-900 dark:text-white transition-colors duration-300">
    <!-- Sticky Navigation -->
    <header class="sticky top-0 z-50 bg-white dark:bg-gray-800 shadow-md border-b border-gray-200 dark:border-gray-700">
        <nav class="container mx-auto px-4 py-3" role="navigation" aria-label="Main navigation">
            <div class="flex items-center justify-between">
                <!-- Logo -->
                <div class="flex items-center space-x-2 cursor-pointer" onclick="showPage('home')">
                    <div class="w-8 h-8 bg-primary-500 rounded-lg flex items-center justify-center">
                        <i class="fas fa-users text-white text-sm"></i>
                    </div>
                    <span class="text-xl font-bold"><span class="text-primary-600 dark:text-primary-400">Bharat</span><span class="text-orange-500">Bulletin</span></span>
                </div>

                <!-- Desktop Navigation -->
                <div class="hidden md:flex items-center space-x-8">
                    <a href="#" onclick="showPage('home')" class="nav-link text-gray-700 dark:text-gray-300 hover:text-primary-600 dark:hover:text-primary-400 transition-colors">Home</a>
                    <a href="#" onclick="showPage('announcements')" class="nav-link text-gray-700 dark:text-gray-300 hover:text-primary-600 dark:hover:text-primary-400 transition-colors">Announcements</a>
                    <a href="#" onclick="showPage('events')" class="nav-link text-gray-700 dark:text-gray-300 hover:text-primary-600 dark:hover:text-primary-400 transition-colors">Events</a>
                    <a href="#" onclick="showPage('marketplace')" class="nav-link text-gray-700 dark:text-gray-300 hover:text-primary-600 dark:hover:text-primary-400 transition-colors">Buy/Sell</a>
                    <a href="#" onclick="showPage('contacts')" class="nav-link text-gray-700 dark:text-gray-300 hover:text-primary-600 dark:hover:text-primary-400 transition-colors">Contacts</a>
                </div>

                <!-- User Menu & Dark Mode Toggle -->
                <div class="hidden md:flex items-center space-x-4">
                    <button onclick="toggleDarkMode()" class="p-2 rounded-lg bg-gray-100 dark:bg-gray-700 hover:bg-gray-200 dark:hover:bg-gray-600 transition-colors" aria-label="Toggle dark mode">
                        <i class="fas fa-moon dark:hidden text-gray-600"></i>
                        <i class="fas fa-sun hidden dark:inline text-yellow-400"></i>
                    </button>
                    
                    <!-- Guest State -->
                    <div id="guestState" class="flex items-center space-x-4">
                        <button onclick="openAuthModal()" class="bg-primary-500 hover:bg-primary-600 text-white px-4 py-2 rounded-lg transition-colors">
                            <i class="fas fa-sign-in-alt mr-2"></i>Sign In
                        </button>
                    </div>
                    
                    <!-- Logged In State -->
                    <div id="userState" class="hidden flex items-center space-x-4">
                        <div class="flex items-center space-x-3">
                            <div class="w-8 h-8 bg-primary-500 rounded-full flex items-center justify-center">
                                <img id="userAvatar" src="" alt="User" class="w-8 h-8 rounded-full hidden">
                                <i id="userAvatarIcon" class="fas fa-user text-white text-sm"></i>
                            </div>
                            <div class="text-right">
                                <div id="userName" class="text-sm font-medium text-gray-900 dark:text-white">Welcome</div>
                                <div id="userEmail" class="text-xs text-gray-500 dark:text-gray-400">user@example.com</div>
                            </div>
                        </div>
                        <div class="relative">
                            <button onclick="toggleUserMenu()" class="p-2 rounded-lg bg-gray-100 dark:bg-gray-700 hover:bg-gray-200 dark:hover:bg-gray-600 transition-colors">
                                <i class="fas fa-chevron-down text-gray-600 dark:text-gray-300"></i>
                            </button>
                            <div id="userMenu" class="absolute right-0 mt-2 w-48 bg-white dark:bg-gray-800 rounded-lg shadow-lg border border-gray-200 dark:border-gray-700 hidden z-50">
                                <div class="py-2">
                                    <a href="#" onclick="showUserProfile()" class="block px-4 py-2 text-sm text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700">
                                        <i class="fas fa-user mr-2"></i>Profile
                                    </a>
                                    <a href="#" onclick="showUserSettings()" class="block px-4 py-2 text-sm text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700">
                                        <i class="fas fa-cog mr-2"></i>Settings
                                    </a>
                                    <hr class="my-2 border-gray-200 dark:border-gray-700">
                                    <a href="#" onclick="signOut()" class="block px-4 py-2 text-sm text-red-600 hover:bg-gray-100 dark:hover:bg-gray-700">
                                        <i class="fas fa-sign-out-alt mr-2"></i>Sign Out
                                    </a>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Mobile Menu Button -->
                <button onclick="toggleMobileMenu()" class="md:hidden p-2 rounded-lg bg-gray-100 dark:bg-gray-700" aria-label="Toggle mobile menu">
                    <i class="fas fa-bars"></i>
                </button>
            </div>

            <!-- Mobile Navigation -->
            <div id="mobileMenu" class="hidden md:hidden mt-4 pb-4 border-t border-gray-200 dark:border-gray-700">
                <div class="flex flex-col space-y-3 pt-4">
                    <a href="#" onclick="showPage('home')" class="nav-link text-gray-700 dark:text-gray-300 hover:text-primary-600 dark:hover:text-primary-400 transition-colors">Home</a>
                    <a href="#" onclick="showPage('announcements')" class="nav-link text-gray-700 dark:text-gray-300 hover:text-primary-600 dark:hover:text-primary-400 transition-colors">Announcements</a>
                    <a href="#" onclick="showPage('events')" class="nav-link text-gray-700 dark:text-gray-300 hover:text-primary-600 dark:hover:text-primary-400 transition-colors">Events</a>
                    <a href="#" onclick="showPage('marketplace')" class="nav-link text-gray-700 dark:text-gray-300 hover:text-primary-600 dark:hover:text-primary-400 transition-colors">Buy/Sell</a>
                    <a href="#" onclick="showPage('contacts')" class="nav-link text-gray-700 dark:text-gray-300 hover:text-primary-600 dark:hover:text-primary-400 transition-colors">Contacts</a>
                    <div class="flex items-center space-x-4 pt-2">
                        <button onclick="toggleDarkMode()" class="p-2 rounded-lg bg-gray-100 dark:bg-gray-700 hover:bg-gray-200 dark:hover:bg-gray-600 transition-colors" aria-label="Toggle dark mode">
                            <i class="fas fa-moon dark:hidden text-gray-600"></i>
                            <i class="fas fa-sun hidden dark:inline text-yellow-400"></i>
                        </button>
                        <button onclick="openAuthModal()" class="bg-primary-500 hover:bg-primary-600 text-white px-4 py-2 rounded-lg transition-colors">
                            <i class="fas fa-sign-in-alt mr-2"></i>Sign In
                        </button>
                    </div>
                </div>
            </div>
        </nav>
    </header>

    <!-- Important Notification Banner -->
    <div class="bg-red-500 text-white py-2 px-4 text-center" role="alert">
        <div class="container mx-auto">
            <i class="fas fa-exclamation-triangle mr-2"></i>
            <strong>Important:</strong> Water supply will be interrupted tomorrow (Dec 21) from 10 AM to 2 PM for maintenance.
        </div>
    </div>

    <!-- Main Content Container -->
    <main id="mainContent">
        
        <!-- HOME PAGE -->
        <div id="homePage" class="page-content">
            <!-- Hero Section -->
            <section class="bg-gradient-to-br from-primary-50 to-blue-100 dark:from-gray-800 dark:to-gray-900 py-16">
                <div class="container mx-auto px-4 text-center">
                    <div class="max-w-4xl mx-auto">
                        <h1 class="text-4xl md:text-6xl font-bold text-gray-900 dark:text-white mb-6">
                            Stay Connected with <span class="text-primary-600">Bharat</span><span class="text-orange-500">Bulletin</span>
                        </h1>
                        <p class="text-xl text-gray-600 dark:text-gray-300 mb-8 max-w-2xl mx-auto">
                            Your hyperlocal digital hub for community news, events, classifieds, and important updates. 
                            Discover what's happening in your neighborhood across India.
                        </p>
                        <div class="flex flex-col sm:flex-row gap-4 justify-center">
                            <button onclick="showPage('announcements')" class="bg-primary-500 hover:bg-primary-600 text-white px-8 py-3 rounded-lg font-semibold transition-colors">
                                <i class="fas fa-bullhorn mr-2"></i>View Latest Updates
                            </button>
                            <button onclick="showPage('events')" class="border-2 border-primary-500 text-primary-500 hover:bg-primary-500 hover:text-white px-8 py-3 rounded-lg font-semibold transition-colors">
                                <i class="fas fa-calendar mr-2"></i>Upcoming Events
                            </button>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Location Access Section -->
            <section class="py-8 bg-white dark:bg-gray-800 border-b border-gray-200 dark:border-gray-700">
                <div class="container mx-auto px-4">
                    <div class="flex flex-col md:flex-row items-center justify-between max-w-4xl mx-auto">
                        <div class="flex items-center space-x-4 mb-4 md:mb-0">
                            <div class="w-12 h-12 bg-orange-100 dark:bg-orange-900 rounded-full flex items-center justify-center">
                                <i class="fas fa-map-marker-alt text-orange-500 text-xl"></i>
                            </div>
                            <div>
                                <h3 class="font-semibold text-gray-900 dark:text-white">Get Local News</h3>
                                <p class="text-sm text-gray-600 dark:text-gray-300" id="locationText">Enable location to see news from your area</p>
                            </div>
                        </div>
                        <button onclick="requestLocation()" id="locationBtn" class="bg-orange-500 hover:bg-orange-600 text-white px-6 py-2 rounded-lg font-medium transition-colors">
                            <i class="fas fa-location-arrow mr-2"></i>Enable Location
                        </button>
                    </div>
                </div>
            </section>

            <!-- Interactive Map Section -->
            <section class="py-8 bg-gray-50 dark:bg-gray-900">
                <div class="container mx-auto px-4">
                    <div class="text-center mb-8">
                        <h2 class="text-3xl font-bold text-gray-900 dark:text-white mb-4">
                            <i class="fas fa-map text-primary-500 mr-3"></i>Community Map
                        </h2>
                        <p class="text-gray-600 dark:text-gray-300">Explore your neighborhood and discover local events, announcements, and weather</p>
                    </div>
                    <div class="max-w-6xl mx-auto">
                        <div id="communityMap" class="w-full h-96 rounded-xl shadow-lg border border-gray-200 dark:border-gray-700"></div>
                        <div class="mt-4 flex flex-wrap gap-2 justify-center">
                            <button onclick="showMapLayer('events')" class="map-layer-btn active bg-primary-500 text-white px-4 py-2 rounded-lg font-medium">
                                <i class="fas fa-calendar mr-2"></i>Events
                            </button>
                            <button onclick="showMapLayer('announcements')" class="map-layer-btn bg-gray-200 dark:bg-gray-700 text-gray-700 dark:text-gray-300 px-4 py-2 rounded-lg font-medium">
                                <i class="fas fa-bullhorn mr-2"></i>Announcements
                            </button>
                            <button onclick="showMapLayer('weather')" class="map-layer-btn bg-gray-200 dark:bg-gray-700 text-gray-700 dark:text-gray-300 px-4 py-2 rounded-lg font-medium">
                                <i class="fas fa-cloud mr-2"></i>Weather
                            </button>
                            <button onclick="showMapLayer('all')" class="map-layer-btn bg-gray-200 dark:bg-gray-700 text-gray-700 dark:text-gray-300 px-4 py-2 rounded-lg font-medium">
                                <i class="fas fa-layer-group mr-2"></i>All
                            </button>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Weather Widget Section -->
            <section class="py-8 bg-gradient-to-r from-blue-50 to-cyan-50 dark:from-gray-800 dark:to-gray-900">
                <div class="container mx-auto px-4">
                    <div class="text-center mb-8">
                        <h2 class="text-3xl font-bold text-gray-900 dark:text-white mb-4">
                            <i class="fas fa-cloud-sun text-blue-500 mr-3"></i>Local Weather
                        </h2>
                        <p class="text-gray-600 dark:text-gray-300">Real-time weather information for your area</p>
                    </div>
                    <div class="max-w-4xl mx-auto">
                        <div class="grid grid-cols-1 md:grid-cols-3 gap-6" id="weatherWidgets">
                            <!-- Weather widgets will be populated here -->
                        </div>
                    </div>
                </div>
            </section>

            <!-- National News Section (Default) -->
            <section id="nationalNewsSection" class="py-12 bg-gradient-to-r from-blue-50 to-primary-50 dark:from-gray-800 dark:to-gray-900">
                <div class="container mx-auto px-4">
                    <div class="text-center mb-8">
                        <h2 class="text-3xl font-bold text-gray-900 dark:text-white mb-4">
                            <i class="fas fa-globe text-primary-500 mr-3"></i>National News
                        </h2>
                        <p class="text-gray-600 dark:text-gray-300">Latest updates from across India</p>
                    </div>
                    <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6" id="nationalNewsGrid">
                        <!-- National news will be populated here -->
                    </div>
                </div>
            </section>

            <!-- Local News Section (Hidden by default) -->
            <section id="localNewsSection" class="py-12 bg-gradient-to-r from-orange-50 to-primary-50 dark:from-gray-800 dark:to-gray-900 hidden">
                <div class="container mx-auto px-4">
                    <div class="text-center mb-8">
                        <h2 class="text-3xl font-bold text-gray-900 dark:text-white mb-4">
                            <i class="fas fa-newspaper text-orange-500 mr-3"></i>Local News
                        </h2>
                        <p class="text-gray-600 dark:text-gray-300" id="localNewsSubtitle">Latest updates from your area</p>
                    </div>
                    <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6" id="localNewsGrid">
                        <!-- Local news will be populated here -->
                    </div>
                </div>
            </section>

            <!-- Quick Stats Section -->
            <section class="py-12">
                <div class="container mx-auto px-4">
                    <div class="grid grid-cols-1 md:grid-cols-4 gap-6">
                        <div class="bg-white dark:bg-gray-800 rounded-xl shadow-lg p-6 text-center">
                            <div class="w-12 h-12 bg-primary-100 dark:bg-primary-900 rounded-full flex items-center justify-center mx-auto mb-4">
                                <i class="fas fa-bullhorn text-primary-500 text-xl"></i>
                            </div>
                            <h3 class="text-2xl font-bold text-gray-900 dark:text-white mb-2">150+</h3>
                            <p class="text-gray-600 dark:text-gray-300">Active Announcements</p>
                        </div>
                        <div class="bg-white dark:bg-gray-800 rounded-xl shadow-lg p-6 text-center">
                            <div class="w-12 h-12 bg-green-100 dark:bg-green-900 rounded-full flex items-center justify-center mx-auto mb-4">
                                <i class="fas fa-calendar-alt text-green-500 text-xl"></i>
                            </div>
                            <h3 class="text-2xl font-bold text-gray-900 dark:text-white mb-2">25</h3>
                            <p class="text-gray-600 dark:text-gray-300">Upcoming Events</p>
                        </div>
                        <div class="bg-white dark:bg-gray-800 rounded-xl shadow-lg p-6 text-center">
                            <div class="w-12 h-12 bg-orange-100 dark:bg-orange-900 rounded-full flex items-center justify-center mx-auto mb-4">
                                <i class="fas fa-store text-orange-500 text-xl"></i>
                            </div>
                            <h3 class="text-2xl font-bold text-gray-900 dark:text-white mb-2">89</h3>
                            <p class="text-gray-600 dark:text-gray-300">Marketplace Listings</p>
                        </div>
                        <div class="bg-white dark:bg-gray-800 rounded-xl shadow-lg p-6 text-center">
                            <div class="w-12 h-12 bg-purple-100 dark:bg-purple-900 rounded-full flex items-center justify-center mx-auto mb-4">
                                <i class="fas fa-users text-purple-500 text-xl"></i>
                            </div>
                            <h3 class="text-2xl font-bold text-gray-900 dark:text-white mb-2">2.5K+</h3>
                            <p class="text-gray-600 dark:text-gray-300">Community Members</p>
                        </div>
                    </div>
                </div>
            </section>
        </div>

        <!-- ANNOUNCEMENTS PAGE -->
        <div id="announcementsPage" class="page-content hidden">
            <section class="py-12">
                <div class="container mx-auto px-4">
                    <div class="text-center mb-12">
                        <h1 class="text-4xl font-bold text-gray-900 dark:text-white mb-4">
                            <i class="fas fa-bullhorn text-primary-500 mr-3"></i>Community Announcements
                        </h1>
                        <p class="text-gray-600 dark:text-gray-300 max-w-2xl mx-auto">
                            Stay informed with the latest updates, notices, and important information from your community.
                        </p>
                    </div>

                    <!-- Filter Tabs -->
                    <div class="flex flex-wrap justify-center mb-8 space-x-2">
                        <button class="announcement-filter active bg-primary-500 text-white px-4 py-2 rounded-lg font-medium mb-2" data-filter="all">All</button>
                        <button class="announcement-filter bg-gray-200 dark:bg-gray-700 text-gray-700 dark:text-gray-300 px-4 py-2 rounded-lg font-medium mb-2" data-filter="urgent">Urgent</button>
                        <button class="announcement-filter bg-gray-200 dark:bg-gray-700 text-gray-700 dark:text-gray-300 px-4 py-2 rounded-lg font-medium mb-2" data-filter="maintenance">Maintenance</button>
                        <button class="announcement-filter bg-gray-200 dark:bg-gray-700 text-gray-700 dark:text-gray-300 px-4 py-2 rounded-lg font-medium mb-2" data-filter="general">General</button>
                        <button class="announcement-filter bg-gray-200 dark:bg-gray-700 text-gray-700 dark:text-gray-300 px-4 py-2 rounded-lg font-medium mb-2" data-filter="events">Events</button>
                        <button class="announcement-filter bg-gray-200 dark:bg-gray-700 text-gray-700 dark:text-gray-300 px-4 py-2 rounded-lg font-medium mb-2" data-filter="nearby">Nearby</button>
                    </div>

                    <!-- Announcements Grid -->
                    <div class="grid grid-cols-1 lg:grid-cols-2 gap-6" id="announcementsGrid">
                        <!-- Announcements will be populated here -->
                    </div>

                    <!-- Load More Button -->
                    <div class="text-center mt-12">
                        <button onclick="loadMoreAnnouncements()" id="loadMoreAnnouncementsBtn" class="bg-primary-500 hover:bg-primary-600 text-white px-8 py-3 rounded-lg font-semibold transition-colors">
                            <i class="fas fa-chevron-down mr-2"></i>Load More Announcements
                        </button>
                    </div>
                </div>
            </section>
        </div>

        <!-- EVENTS PAGE -->
        <div id="eventsPage" class="page-content hidden">
            <section class="py-12">
                <div class="container mx-auto px-4">
                    <div class="text-center mb-12">
                        <h1 class="text-4xl font-bold text-gray-900 dark:text-white mb-4">
                            <i class="fas fa-calendar-alt text-primary-500 mr-3"></i>Community Events
                        </h1>
                        <p class="text-gray-600 dark:text-gray-300 max-w-2xl mx-auto">
                            Join exciting events, festivals, and activities happening in your community.
                        </p>
                    </div>

                    <!-- Event Search and Filters -->
                    <div class="max-w-4xl mx-auto mb-8">
                        <div class="bg-white dark:bg-gray-800 rounded-xl shadow-lg p-6">
                            <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2">Search by Date</label>
                                    <input type="date" id="eventDatePicker" class="w-full px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-transparent dark:bg-gray-700 dark:text-white" onchange="filterEventsByDate()">
                                </div>
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2">Category</label>
                                    <select id="eventCategoryFilter" class="w-full px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-transparent dark:bg-gray-700 dark:text-white" onchange="filterEventsByCategory()">
                                        <option value="all">All Categories</option>
                                        <option value="cultural">Cultural</option>
                                        <option value="recreational">Recreational</option>
                                        <option value="official">Official</option>
                                        <option value="sports">Sports</option>
                                    </select>
                                </div>
                                <div class="flex items-end">
                                    <button onclick="clearEventFilters()" class="w-full bg-gray-500 hover:bg-gray-600 text-white px-4 py-2 rounded-lg font-medium transition-colors">
                                        <i class="fas fa-times mr-2"></i>Clear Filters
                                    </button>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Event Categories -->
                    <div class="flex flex-wrap justify-center mb-8 space-x-2">
                        <button class="event-filter active bg-primary-500 text-white px-4 py-2 rounded-lg font-medium mb-2" data-filter="all">All Events</button>
                        <button class="event-filter bg-gray-200 dark:bg-gray-700 text-gray-700 dark:text-gray-300 px-4 py-2 rounded-lg font-medium mb-2" data-filter="cultural">Cultural</button>
                        <button class="event-filter bg-gray-200 dark:bg-gray-700 text-gray-700 dark:text-gray-300 px-4 py-2 rounded-lg font-medium mb-2" data-filter="recreational">Recreational</button>
                        <button class="event-filter bg-gray-200 dark:bg-gray-700 text-gray-700 dark:text-gray-300 px-4 py-2 rounded-lg font-medium mb-2" data-filter="official">Official</button>
                        <button class="event-filter bg-gray-200 dark:bg-gray-700 text-gray-700 dark:text-gray-300 px-4 py-2 rounded-lg font-medium mb-2" data-filter="sports">Sports</button>
                    </div>

                    <!-- Events Grid -->
                    <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6" id="eventsGrid">
                        <!-- Events will be populated here -->
                    </div>

                    <!-- No Events Message -->
                    <div id="noEventsMessage" class="text-center py-12 hidden">
                        <div class="w-16 h-16 bg-gray-200 dark:bg-gray-700 rounded-full flex items-center justify-center mx-auto mb-4">
                            <i class="fas fa-calendar-times text-gray-500 text-2xl"></i>
                        </div>
                        <h3 class="text-xl font-semibold text-gray-900 dark:text-white mb-2">No Events Found</h3>
                        <p class="text-gray-600 dark:text-gray-300">No events match your selected criteria. Try adjusting your filters.</p>
                    </div>
                </div>
            </section>
        </div>

        <!-- MARKETPLACE PAGE -->
        <div id="marketplacePage" class="page-content hidden">
            <section class="py-12">
                <div class="container mx-auto px-4">
                    <div class="text-center mb-12">
                        <h1 class="text-4xl font-bold text-gray-900 dark:text-white mb-4">
                            <i class="fas fa-store text-primary-500 mr-3"></i>Community Marketplace
                        </h1>
                        <p class="text-gray-600 dark:text-gray-300 max-w-2xl mx-auto">
                            Buy, sell, rent, or find services within your community. Connect with neighbors for all your needs.
                        </p>
                    </div>

                    <!-- Post Ad Button -->
                    <div class="text-center mb-8">
                        <button onclick="openPostAdModal()" class="bg-gradient-to-r from-orange-500 to-orange-600 hover:from-orange-600 hover:to-orange-700 text-white px-8 py-3 rounded-lg font-semibold transition-all transform hover:scale-105 shadow-lg">
                            <i class="fas fa-plus mr-2"></i>Post New Ad
                        </button>
                    </div>

                    <!-- Category Filters -->
                    <div class="flex flex-wrap justify-center mb-8 space-x-2">
                        <button class="marketplace-filter active bg-primary-500 text-white px-4 py-2 rounded-lg font-medium mb-2" data-filter="all">All Items</button>
                        <button class="marketplace-filter bg-gray-200 dark:bg-gray-700 text-gray-700 dark:text-gray-300 px-4 py-2 rounded-lg font-medium mb-2" data-filter="sale">For Sale</button>
                        <button class="marketplace-filter bg-gray-200 dark:bg-gray-700 text-gray-700 dark:text-gray-300 px-4 py-2 rounded-lg font-medium mb-2" data-filter="rent">For Rent</button>
                        <button class="marketplace-filter bg-gray-200 dark:bg-gray-700 text-gray-700 dark:text-gray-300 px-4 py-2 rounded-lg font-medium mb-2" data-filter="wanted">Wanted</button>
                        <button class="marketplace-filter bg-gray-200 dark:bg-gray-700 text-gray-700 dark:text-gray-300 px-4 py-2 rounded-lg font-medium mb-2" data-filter="free">Free</button>
                        <button class="marketplace-filter bg-gray-200 dark:bg-gray-700 text-gray-700 dark:text-gray-300 px-4 py-2 rounded-lg font-medium mb-2" data-filter="services">Services</button>
                    </div>

                    <!-- Marketplace Grid -->
                    <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-6" id="marketplaceGrid">
                        <!-- Marketplace items will be populated here -->
                    </div>
                </div>
            </section>
        </div>

        <!-- CONTACTS PAGE -->
        <div id="contactsPage" class="page-content hidden">
            <section class="py-12">
                <div class="container mx-auto px-4">
                    <div class="text-center mb-12">
                        <h1 class="text-4xl font-bold text-gray-900 dark:text-white mb-4">
                            <i class="fas fa-address-book text-primary-500 mr-3"></i>Important Contacts
                        </h1>
                        <p class="text-gray-600 dark:text-gray-300 max-w-2xl mx-auto">
                            Quick access to essential contacts for your community needs and emergencies.
                        </p>
                    </div>

                    <!-- Emergency Contacts Banner -->
                    <div class="bg-red-50 dark:bg-red-900/20 border border-red-200 dark:border-red-800 rounded-xl p-6 mb-8">
                        <h2 class="text-xl font-bold text-red-800 dark:text-red-200 mb-4 flex items-center">
                            <i class="fas fa-exclamation-triangle mr-2"></i>Emergency Contacts
                        </h2>
                        <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
                            <div class="text-center">
                                <p class="font-medium text-red-800 dark:text-red-200">Police</p>
                                <a href="tel:100" class="text-2xl font-bold text-red-600 hover:text-red-700">100</a>
                            </div>
                            <div class="text-center">
                                <p class="font-medium text-red-800 dark:text-red-200">Fire Department</p>
                                <a href="tel:101" class="text-2xl font-bold text-red-600 hover:text-red-700">101</a>
                            </div>
                            <div class="text-center">
                                <p class="font-medium text-red-800 dark:text-red-200">Ambulance</p>
                                <a href="tel:108" class="text-2xl font-bold text-red-600 hover:text-red-700">108</a>
                            </div>
                        </div>
                    </div>

                    <!-- Contact Categories -->
                    <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8" id="contactsGrid">
                        <!-- Contacts will be populated here -->
                    </div>

                    <!-- Contact Form -->
                    <div class="mt-12 max-w-4xl mx-auto bg-white dark:bg-gray-800 rounded-xl shadow-lg p-8">
                        <div class="text-center mb-8">
                            <h2 class="text-2xl font-bold text-gray-900 dark:text-white mb-4">Get in Touch</h2>
                            <p class="text-gray-600 dark:text-gray-300">
                                Need to add a contact or report an issue? Send us a message.
                            </p>
                        </div>
                        <form class="grid grid-cols-1 md:grid-cols-2 gap-6">
                            <div>
                                <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2">Your Name</label>
                                <input type="text" class="w-full px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-transparent dark:bg-gray-700 dark:text-white" placeholder="Enter your name">
                            </div>
                            <div>
                                <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2">Contact Number</label>
                                <input type="tel" class="w-full px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-transparent dark:bg-gray-700 dark:text-white" placeholder="Your phone number">
                            </div>
                            <div class="md:col-span-2">
                                <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2">Subject</label>
                                <select class="w-full px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-transparent dark:bg-gray-700 dark:text-white">
                                    <option>Add New Contact</option>
                                    <option>Update Existing Contact</option>
                                    <option>Report Issue</option>
                                    <option>General Inquiry</option>
                                </select>
                            </div>
                            <div class="md:col-span-2">
                                <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2">Message</label>
                                <textarea rows="4" class="w-full px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-transparent dark:bg-gray-700 dark:text-white" placeholder="Your message..."></textarea>
                            </div>
                            <div class="md:col-span-2 text-center">
                                <button type="submit" class="bg-primary-500 hover:bg-primary-600 text-white px-8 py-3 rounded-lg font-semibold transition-colors">
                                    <i class="fas fa-paper-plane mr-2"></i>Send Message
                                </button>
                            </div>
                        </form>
                    </div>
                </div>
            </section>
        </div>

    </main>

    <!-- Footer -->
    <footer class="bg-gray-900 text-white py-12">
        <div class="container mx-auto px-4">
            <div class="grid grid-cols-1 md:grid-cols-4 gap-8">
                <!-- Brand -->
                <div>
                    <div class="flex items-center space-x-2 mb-4">
                        <div class="w-8 h-8 bg-primary-500 rounded-lg flex items-center justify-center">
                            <i class="fas fa-users text-white text-sm"></i>
                        </div>
                        <span class="text-xl font-bold"><span class="text-primary-400">Bharat</span><span class="text-orange-400">Bulletin</span></span>
                    </div>
                    <p class="text-gray-400 text-sm mb-4">
                        Connecting communities through digital innovation. Building stronger neighborhoods together.
                    </p>
                    <div class="flex space-x-4">
                        <a href="#" class="text-gray-400 hover:text-primary-400 transition-colors" aria-label="WhatsApp Group">
                            <i class="fab fa-whatsapp text-xl"></i>
                        </a>
                        <a href="#" class="text-gray-400 hover:text-primary-400 transition-colors" aria-label="Facebook Page">
                            <i class="fab fa-facebook text-xl"></i>
                        </a>
                        <a href="#" class="text-gray-400 hover:text-primary-400 transition-colors" aria-label="Telegram Channel">
                            <i class="fab fa-telegram text-xl"></i>
                        </a>
                    </div>
                </div>

                <!-- Quick Links -->
                <div>
                    <h3 class="font-semibold mb-4">Quick Links</h3>
                    <ul class="space-y-2 text-sm">
                        <li><a href="#" onclick="showPage('announcements')" class="text-gray-400 hover:text-white transition-colors">Announcements</a></li>
                        <li><a href="#" onclick="showPage('events')" class="text-gray-400 hover:text-white transition-colors">Events</a></li>
                        <li><a href="#" onclick="showPage('marketplace')" class="text-gray-400 hover:text-white transition-colors">Buy/Sell/Rent</a></li>
                        <li><a href="#" onclick="showPage('contacts')" class="text-gray-400 hover:text-white transition-colors">Important Contacts</a></li>
                    </ul>
                </div>

                <!-- Community -->
                <div>
                    <h3 class="font-semibold mb-4">Community</h3>
                    <ul class="space-y-2 text-sm">
                        <li><a href="#" class="text-gray-400 hover:text-white transition-colors">Society Rules</a></li>
                        <li><a href="#" class="text-gray-400 hover:text-white transition-colors">Meeting Minutes</a></li>
                        <li><a href="#" class="text-gray-400 hover:text-white transition-colors">Photo Gallery</a></li>
                        <li><a href="#" class="text-gray-400 hover:text-white transition-colors">Newsletter Archive</a></li>
                    </ul>
                </div>

                <!-- Support -->
                <div>
                    <h3 class="font-semibold mb-4">Support</h3>
                    <ul class="space-y-2 text-sm">
                        <li><a href="#" class="text-gray-400 hover:text-white transition-colors">About Us</a></li>
                        <li><a href="#" class="text-gray-400 hover:text-white transition-colors">Privacy Policy</a></li>
                        <li><a href="#" class="text-gray-400 hover:text-white transition-colors">Terms of Use</a></li>
                        <li><a href="#" class="text-gray-400 hover:text-white transition-colors">Contact Support</a></li>
                    </ul>
                </div>
            </div>

            <div class="border-t border-gray-800 mt-8 pt-8 text-center">
                <p class="text-gray-400 text-sm">
                    © 2024 BharatBulletin. All rights reserved. | Designed for better community living.
                </p>
            </div>
        </div>
    </footer>

    <!-- Modern Futuristic Post Ad Modal -->
    <div id="postAdModal" class="fixed inset-0 bg-black bg-opacity-60 backdrop-blur-sm z-50 hidden flex items-center justify-center p-4">
        <div class="bg-gradient-to-br from-white to-gray-50 dark:from-gray-800 dark:to-gray-900 rounded-3xl shadow-2xl max-w-4xl w-full p-8 relative max-h-[90vh] overflow-y-auto border border-gray-200 dark:border-gray-700">
            <button onclick="closePostAdModal()" class="absolute top-6 right-6 w-10 h-10 bg-gray-100 dark:bg-gray-700 hover:bg-gray-200 dark:hover:bg-gray-600 rounded-full flex items-center justify-center transition-all transform hover:scale-110">
                <i class="fas fa-times text-gray-600 dark:text-gray-300"></i>
            </button>
            
            <div class="text-center mb-8">
                <div class="w-16 h-16 bg-gradient-to-r from-orange-500 to-orange-600 rounded-2xl flex items-center justify-center mx-auto mb-4">
                    <i class="fas fa-rocket text-white text-2xl"></i>
                </div>
                <h2 class="text-4xl font-bold bg-gradient-to-r from-orange-500 to-orange-600 bg-clip-text text-transparent mb-2">Post Your Ad</h2>
                <p class="text-gray-600 dark:text-gray-400">Share your listing with the community in seconds</p>
            </div>

            <form id="postAdForm" class="space-y-8">
                <!-- Ad Type & Category -->
                <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                    <div class="space-y-2">
                        <label class="block text-sm font-semibold text-gray-700 dark:text-gray-300 mb-3">Ad Type</label>
                        <div class="grid grid-cols-2 gap-2">
                            <label class="relative">
                                <input type="radio" name="adType" value="sale" class="sr-only peer" required>
                                <div class="p-4 border-2 border-gray-200 dark:border-gray-600 rounded-xl cursor-pointer transition-all peer-checked:border-green-500 peer-checked:bg-green-50 dark:peer-checked:bg-green-900/20 hover:border-green-300">
                                    <i class="fas fa-tag text-green-500 text-xl mb-2 block"></i>
                                    <span class="font-medium text-gray-700 dark:text-gray-300">For Sale</span>
                                </div>
                            </label>
                            <label class="relative">
                                <input type="radio" name="adType" value="rent" class="sr-only peer">
                                <div class="p-4 border-2 border-gray-200 dark:border-gray-600 rounded-xl cursor-pointer transition-all peer-checked:border-blue-500 peer-checked:bg-blue-50 dark:peer-checked:bg-blue-900/20 hover:border-blue-300">
                                    <i class="fas fa-home text-blue-500 text-xl mb-2 block"></i>
                                    <span class="font-medium text-gray-700 dark:text-gray-300">For Rent</span>
                                </div>
                            </label>
                            <label class="relative">
                                <input type="radio" name="adType" value="wanted" class="sr-only peer">
                                <div class="p-4 border-2 border-gray-200 dark:border-gray-600 rounded-xl cursor-pointer transition-all peer-checked:border-orange-500 peer-checked:bg-orange-50 dark:peer-checked:bg-orange-900/20 hover:border-orange-300">
                                    <i class="fas fa-search text-orange-500 text-xl mb-2 block"></i>
                                    <span class="font-medium text-gray-700 dark:text-gray-300">Wanted</span>
                                </div>
                            </label>
                            <label class="relative">
                                <input type="radio" name="adType" value="services" class="sr-only peer">
                                <div class="p-4 border-2 border-gray-200 dark:border-gray-600 rounded-xl cursor-pointer transition-all peer-checked:border-purple-500 peer-checked:bg-purple-50 dark:peer-checked:bg-purple-900/20 hover:border-purple-300">
                                    <i class="fas fa-tools text-purple-500 text-xl mb-2 block"></i>
                                    <span class="font-medium text-gray-700 dark:text-gray-300">Services</span>
                                </div>
                            </label>
                        </div>
                    </div>
                    <div>
                        <label class="block text-sm font-semibold text-gray-700 dark:text-gray-300 mb-3">Category</label>
                        <select id="adCategory" class="w-full px-4 py-4 border-2 border-gray-200 dark:border-gray-600 rounded-xl focus:ring-2 focus:ring-orange-500 focus:border-orange-500 dark:bg-gray-700 dark:text-white transition-all" required>
                            <option value="">Select Category</option>
                            <option value="electronics">📱 Electronics</option>
                            <option value="furniture">🪑 Furniture</option>
                            <option value="vehicles">🚗 Vehicles</option>
                            <option value="books">📚 Books & Education</option>
                            <option value="clothing">👕 Clothing</option>
                            <option value="sports">⚽ Sports & Fitness</option>
                            <option value="home">🏠 Home & Garden</option>
                            <option value="services">🔧 Services</option>
                            <option value="other">📦 Other</option>
                        </select>
                    </div>
                </div>

                <!-- Title -->
                <div>
                    <label class="block text-sm font-semibold text-gray-700 dark:text-gray-300 mb-3">Title</label>
                    <input type="text" id="adTitle" class="w-full px-4 py-4 border-2 border-gray-200 dark:border-gray-600 rounded-xl focus:ring-2 focus:ring-orange-500 focus:border-orange-500 dark:bg-gray-700 dark:text-white transition-all" placeholder="Enter a catchy title for your ad" required>
                </div>

                <!-- Description -->
                <div>
                    <label class="block text-sm font-semibold text-gray-700 dark:text-gray-300 mb-3">Description</label>
                    <textarea id="adDescription" rows="4" class="w-full px-4 py-4 border-2 border-gray-200 dark:border-gray-600 rounded-xl focus:ring-2 focus:ring-orange-500 focus:border-orange-500 dark:bg-gray-700 dark:text-white transition-all" placeholder="Describe your item in detail..." required></textarea>
                </div>

                <!-- Price & Condition -->
                <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                    <div>
                        <label class="block text-sm font-semibold text-gray-700 dark:text-gray-300 mb-3">Price</label>
                        <div class="relative">
                            <span class="absolute left-4 top-1/2 transform -translate-y-1/2 text-gray-500">₹</span>
                            <input type="text" id="adPrice" class="w-full pl-8 pr-4 py-4 border-2 border-gray-200 dark:border-gray-600 rounded-xl focus:ring-2 focus:ring-orange-500 focus:border-orange-500 dark:bg-gray-700 dark:text-white transition-all" placeholder="Enter price or 'Free' or 'Negotiable'">
                        </div>
                    </div>
                    <div>
                        <label class="block text-sm font-semibold text-gray-700 dark:text-gray-300 mb-3">Condition</label>
                        <select id="adCondition" class="w-full px-4 py-4 border-2 border-gray-200 dark:border-gray-600 rounded-xl focus:ring-2 focus:ring-orange-500 focus:border-orange-500 dark:bg-gray-700 dark:text-white transition-all">
                            <option value="">Select Condition</option>
                            <option value="new">🆕 Brand New</option>
                            <option value="like-new">✨ Like New</option>
                            <option value="good">👍 Good</option>
                            <option value="fair">👌 Fair</option>
                            <option value="poor">⚠️ Poor</option>
                        </select>
                    </div>
                </div>

                <!-- Contact Info -->
                <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                    <div>
                        <label class="block text-sm font-semibold text-gray-700 dark:text-gray-300 mb-3">Your Name</label>
                        <input type="text" id="adContactName" class="w-full px-4 py-4 border-2 border-gray-200 dark:border-gray-600 rounded-xl focus:ring-2 focus:ring-orange-500 focus:border-orange-500 dark:bg-gray-700 dark:text-white transition-all" placeholder="Enter your name" required>
                    </div>
                    <div>
                        <label class="block text-sm font-semibold text-gray-700 dark:text-gray-300 mb-3">Phone Number</label>
                        <input type="tel" id="adContactPhone" class="w-full px-4 py-4 border-2 border-gray-200 dark:border-gray-600 rounded-xl focus:ring-2 focus:ring-orange-500 focus:border-orange-500 dark:bg-gray-700 dark:text-white transition-all" placeholder="Enter phone number" required>
                    </div>
                </div>

                <!-- Location -->
                <div>
                    <label class="block text-sm font-semibold text-gray-700 dark:text-gray-300 mb-3">Location</label>
                    <input type="text" id="adLocation" class="w-full px-4 py-4 border-2 border-gray-200 dark:border-gray-600 rounded-xl focus:ring-2 focus:ring-orange-500 focus:border-orange-500 dark:bg-gray-700 dark:text-white transition-all" placeholder="e.g., Apt 204, Block A" required>
                </div>

                <!-- Image Upload -->
                <div>
                    <label class="block text-sm font-semibold text-gray-700 dark:text-gray-300 mb-3">Upload Images</label>
                    <div class="border-2 border-dashed border-gray-300 dark:border-gray-600 rounded-xl p-8 text-center hover:border-orange-500 transition-all">
                        <i class="fas fa-cloud-upload-alt text-4xl text-gray-400 mb-4"></i>
                        <p class="text-gray-600 dark:text-gray-400 mb-2">Drag & drop images here or click to browse</p>
                        <input type="file" id="adImages" multiple accept="image/*" class="hidden">
                        <button type="button" onclick="document.getElementById('adImages').click()" class="bg-orange-500 hover:bg-orange-600 text-white px-6 py-2 rounded-lg transition-colors">
                            Choose Files
                        </button>
                        <p class="text-xs text-gray-500 dark:text-gray-400 mt-2">Up to 5 images, max 5MB each</p>
                    </div>
                </div>

                <!-- Duration -->
                <div>
                    <label class="block text-sm font-semibold text-gray-700 dark:text-gray-300 mb-3">Ad Duration</label>
                    <div class="grid grid-cols-4 gap-2">
                        <label class="relative">
                            <input type="radio" name="adDuration" value="7" class="sr-only peer">
                            <div class="p-3 border-2 border-gray-200 dark:border-gray-600 rounded-lg cursor-pointer transition-all peer-checked:border-orange-500 peer-checked:bg-orange-50 dark:peer-checked:bg-orange-900/20 text-center">
                                <span class="font-medium text-gray-700 dark:text-gray-300">7 Days</span>
                            </div>
                        </label>
                        <label class="relative">
                            <input type="radio" name="adDuration" value="15" class="sr-only peer">
                            <div class="p-3 border-2 border-gray-200 dark:border-gray-600 rounded-lg cursor-pointer transition-all peer-checked:border-orange-500 peer-checked:bg-orange-50 dark:peer-checked:bg-orange-900/20 text-center">
                                <span class="font-medium text-gray-700 dark:text-gray-300">15 Days</span>
                            </div>
                        </label>
                        <label class="relative">
                            <input type="radio" name="adDuration" value="30" class="sr-only peer" checked>
                            <div class="p-3 border-2 border-orange-500 bg-orange-50 dark:bg-orange-900/20 rounded-lg cursor-pointer transition-all text-center">
                                <span class="font-medium text-gray-700 dark:text-gray-300">30 Days</span>
                            </div>
                        </label>
                        <label class="relative">
                            <input type="radio" name="adDuration" value="60" class="sr-only peer">
                            <div class="p-3 border-2 border-gray-200 dark:border-gray-600 rounded-lg cursor-pointer transition-all peer-checked:border-orange-500 peer-checked:bg-orange-50 dark:peer-checked:bg-orange-900/20 text-center">
                                <span class="font-medium text-gray-700 dark:text-gray-300">60 Days</span>
                            </div>
                        </label>
                    </div>
                </div>

                <!-- Terms -->
                <div class="flex items-start space-x-3">
                    <input type="checkbox" id="agreeTerms" class="mt-1 rounded border-gray-300 text-orange-600 focus:ring-orange-500" required>
                    <label for="agreeTerms" class="text-sm text-gray-600 dark:text-gray-400">
                        I agree to the <a href="#" class="text-orange-600 hover:text-orange-500 font-medium">Terms of Service</a> and <a href="#" class="text-orange-600 hover:text-orange-500 font-medium">Community Guidelines</a>. I confirm that all information provided is accurate.
                    </label>
                </div>

                <!-- Submit Buttons -->
                <div class="flex gap-4 pt-4">
                    <button type="button" onclick="closePostAdModal()" class="flex-1 bg-gray-200 dark:bg-gray-700 hover:bg-gray-300 dark:hover:bg-gray-600 text-gray-700 dark:text-gray-300 py-4 rounded-xl font-semibold transition-all">
                        Cancel
                    </button>
                    <button type="submit" class="flex-1 bg-gradient-to-r from-orange-500 to-orange-600 hover:from-orange-600 hover:to-orange-700 text-white py-4 rounded-xl font-semibold transition-all transform hover:scale-105 shadow-lg">
                        <i class="fas fa-rocket mr-2"></i>Post Ad
                    </button>
                </div>
            </form>
        </div>
    </div>

    <!-- Modern Auth Modal -->
    <div id="authModal" class="fixed inset-0 bg-black bg-opacity-50 z-50 hidden flex items-center justify-center p-4">
        <div class="bg-white dark:bg-gray-800 rounded-2xl shadow-2xl max-w-md w-full p-8 relative">
            <button onclick="closeAuthModal()" class="absolute top-4 right-4 text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-200 transition-colors">
                <i class="fas fa-times text-xl"></i>
            </button>
            
            <!-- Auth Toggle -->
            <div class="flex bg-gray-100 dark:bg-gray-700 rounded-lg p-1 mb-8">
                <button onclick="showSignIn()" id="signInTab" class="flex-1 py-2 px-4 rounded-md font-medium transition-colors bg-white dark:bg-gray-600 text-primary-600 dark:text-primary-400 shadow-sm">
                    Sign In
                </button>
                <button onclick="showSignUp()" id="signUpTab" class="flex-1 py-2 px-4 rounded-md font-medium transition-colors text-gray-600 dark:text-gray-400">
                    Sign Up
                </button>
            </div>

            <!-- Sign In Form -->
            <div id="signInForm">
                <div class="text-center mb-6">
                    <h2 class="text-2xl font-bold text-gray-900 dark:text-white mb-2">Welcome Back!</h2>
                    <p class="text-gray-600 dark:text-gray-400">Sign in to access your community</p>
                </div>

                <!-- Social Login Buttons -->
                <div class="space-y-3 mb-6">
                    <div id="googleSignInButton" class="w-full"></div>
                    
                    <button class="w-full flex items-center justify-center px-4 py-3 border border-gray-300 dark:border-gray-600 rounded-lg hover:bg-gray-50 dark:hover:bg-gray-700 transition-colors">
                        <svg class="w-5 h-5 mr-3" fill="#1877F2" viewBox="0 0 24 24">
                            <path d="M24 12.073c0-6.627-5.373-12-12-12s-12 5.373-12 12c0 5.99 4.388 10.954 10.125 11.854v-8.385H7.078v-3.47h3.047V9.43c0-3.007 1.792-4.669 4.533-4.669 1.312 0 2.686.235 2.686.235v2.953H15.83c-1.491 0-1.956.925-1.956 1.874v2.25h3.328l-.532 3.47h-2.796v8.385C19.612 23.027 24 18.062 24 12.073z"/>
                        </svg>
                        <span class="text-gray-700 dark:text-gray-300 font-medium">Continue with Facebook</span>
                    </button>
                </div>

                <div class="relative mb-6">
                    <div class="absolute inset-0 flex items-center">
                        <div class="w-full border-t border-gray-300 dark:border-gray-600"></div>
                    </div>
                    <div class="relative flex justify-center text-sm">
                        <span class="px-2 bg-white dark:bg-gray-800 text-gray-500 dark:text-gray-400">Or continue with email</span>
                    </div>
                </div>

                <form class="space-y-4">
                    <div>
                        <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2">Email</label>
                        <input type="email" class="w-full px-4 py-3 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-transparent dark:bg-gray-700 dark:text-white transition-colors" placeholder="Enter your email">
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2">Password</label>
                        <input type="password" class="w-full px-4 py-3 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-transparent dark:bg-gray-700 dark:text-white transition-colors" placeholder="Enter your password">
                    </div>
                    <div class="flex items-center justify-between">
                        <label class="flex items-center">
                            <input type="checkbox" class="rounded border-gray-300 text-primary-600 focus:ring-primary-500">
                            <span class="ml-2 text-sm text-gray-600 dark:text-gray-400">Remember me</span>
                        </label>
                        <a href="#" class="text-sm text-primary-600 hover:text-primary-500">Forgot password?</a>
                    </div>
                    <button type="submit" class="w-full bg-gradient-to-r from-primary-500 to-primary-600 hover:from-primary-600 hover:to-primary-700 text-white py-3 rounded-lg font-semibold transition-all transform hover:scale-105">
                        Sign In
                    </button>
                </form>
            </div>

            <!-- Sign Up Form -->
            <div id="signUpForm" class="hidden">
                <div class="text-center mb-6">
                    <h2 class="text-2xl font-bold text-gray-900 dark:text-white mb-2">Join BharatBulletin</h2>
                    <p class="text-gray-600 dark:text-gray-400">Create your account to get started</p>
                </div>

                <!-- Social Login Buttons -->
                <div class="space-y-3 mb-6">
                    <div id="googleSignUpButton" class="w-full"></div>
                    
                    <button class="w-full flex items-center justify-center px-4 py-3 border border-gray-300 dark:border-gray-600 rounded-lg hover:bg-gray-50 dark:hover:bg-gray-700 transition-colors">
                        <svg class="w-5 h-5 mr-3" fill="#1877F2" viewBox="0 0 24 24">
                            <path d="M24 12.073c0-6.627-5.373-12-12-12s-12 5.373-12 12c0 5.99 4.388 10.954 10.125 11.854v-8.385H7.078v-3.47h3.047V9.43c0-3.007 1.792-4.669 4.533-4.669 1.312 0 2.686.235 2.686.235v2.953H15.83c-1.491 0-1.956.925-1.956 1.874v2.25h3.328l-.532 3.47h-2.796v8.385C19.612 23.027 24 18.062 24 12.073z"/>
                        </svg>
                        <span class="text-gray-700 dark:text-gray-300 font-medium">Sign up with Facebook</span>
                    </button>
                </div>

                <div class="relative mb-6">
                    <div class="absolute inset-0 flex items-center">
                        <div class="w-full border-t border-gray-300 dark:border-gray-600"></div>
                    </div>
                    <div class="relative flex justify-center text-sm">
                        <span class="px-2 bg-white dark:bg-gray-800 text-gray-500 dark:text-gray-400">Or sign up with email</span>
                    </div>
                </div>

                <form class="space-y-4">
                    <div class="grid grid-cols-2 gap-4">
                        <div>
                            <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2">First Name</label>
                            <input type="text" class="w-full px-4 py-3 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-transparent dark:bg-gray-700 dark:text-white transition-colors" placeholder="First name">
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2">Last Name</label>
                            <input type="text" class="w-full px-4 py-3 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-transparent dark:bg-gray-700 dark:text-white transition-colors" placeholder="Last name">
                        </div>
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2">Email</label>
                        <input type="email" class="w-full px-4 py-3 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-transparent dark:bg-gray-700 dark:text-white transition-colors" placeholder="Enter your email">
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2">Password</label>
                        <input type="password" class="w-full px-4 py-3 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-transparent dark:bg-gray-700 dark:text-white transition-colors" placeholder="Create a password">
                    </div>
                    <div>
                        <label class="flex items-center">
                            <input type="checkbox" class="rounded border-gray-300 text-primary-600 focus:ring-primary-500">
                            <span class="ml-2 text-sm text-gray-600 dark:text-gray-400">I agree to the <a href="#" class="text-primary-600 hover:text-primary-500">Terms of Service</a> and <a href="#" class="text-primary-600 hover:text-primary-500">Privacy Policy</a></span>
                        </label>
                    </div>
                    <button type="submit" class="w-full bg-gradient-to-r from-orange-500 to-orange-600 hover:from-orange-600 hover:to-orange-700 text-white py-3 rounded-lg font-semibold transition-all transform hover:scale-105">
                        Create Account
                    </button>
                </form>
            </div>
        </div>
    </div>

    <script>
        // Global variables
        let userLocation = null;
        let currentPage = 'home';
        let announcementsData = [];
        let eventsData = [];
        let marketplaceData = [];
        let announcementsDisplayed = 6;
        let allEvents = [];
        let filteredEvents = [];
        let currentUser = null;
        let googleClient = null;

        // Initialize the application
        document.addEventListener('DOMContentLoaded', function() {
            initializeDarkMode();
            populateContent();
            showPage('home');
            populateNationalNews();
            initializeGoogleOAuth();
            checkUserAuthState();
            
            // Initialize Leaflet map after a short delay to ensure DOM is ready
            setTimeout(() => {
                initMap();
            }, 500);
            
            // Render Google buttons after a delay
            setTimeout(() => {
                renderGoogleSignInButton();
            }, 1000);
        });

        // Google OAuth Functions
        function initializeGoogleOAuth() {
            // Wait for Google OAuth SDK to load
            const checkGoogleSDK = () => {
                if (typeof google !== 'undefined' && google.accounts && google.accounts.id) {
                    // Initialize Google OAuth client
                    google.accounts.id.initialize({
                        client_id: '780949347688-55r5e4h02jne940703o01ej43sv6uj7s.apps.googleusercontent.com',
                        callback: handleGoogleSignIn
                    });
                    console.log('Google OAuth initialized successfully');
                } else {
                    console.log('Google OAuth SDK not ready, retrying...');
                    setTimeout(checkGoogleSDK, 100);
                }
            };
            
            checkGoogleSDK();
        }

        function renderGoogleSignInButton() {
            if (typeof google !== 'undefined' && google.accounts && google.accounts.id) {
                google.accounts.id.renderButton(
                    document.getElementById('googleSignInButton'),
                    { 
                        theme: 'outline', 
                        size: 'large',
                        width: '100%',
                        text: 'signin_with'
                    }
                );
                
                google.accounts.id.renderButton(
                    document.getElementById('googleSignUpButton'),
                    { 
                        theme: 'outline', 
                        size: 'large',
                        width: '100%',
                        text: 'signup_with'
                    }
                );
            }
        }

        function handleGoogleSignIn(response) {
            try {
                console.log('Google OAuth response received');
                
                // Decode the JWT token to get user info
                const payload = JSON.parse(atob(response.credential.split('.')[1]));
                console.log('User payload:', payload);
                
                currentUser = {
                    id: payload.sub,
                    name: payload.name,
                    email: payload.email,
                    picture: payload.picture,
                    given_name: payload.given_name,
                    family_name: payload.family_name
                };
                
                // Save user data to localStorage
                localStorage.setItem('bharatBulletinUser', JSON.stringify(currentUser));
                
                // Update UI
                updateUserInterface();
                
                // Close auth modal
                closeAuthModal();
                
                // Show welcome message
                showWelcomeMessage();
                
                console.log('User signed in successfully:', currentUser.name);
            } catch (error) {
                console.error('Error handling Google sign in:', error);
                alert('Error processing sign in. Please try again.');
            }
        }

        function signInWithGoogle() {
            try {
                if (typeof google !== 'undefined' && google.accounts && google.accounts.id) {
                    google.accounts.id.prompt();
                } else {
                    console.error('Google OAuth SDK not loaded');
                    alert('Google OAuth is not available. Please try again.');
                }
            } catch (error) {
                console.error('Error with Google OAuth:', error);
                alert('Error with Google OAuth. Please try again.');
            }
        }

        function signUpWithGoogle() {
            try {
                if (typeof google !== 'undefined' && google.accounts && google.accounts.id) {
                    google.accounts.id.prompt();
                } else {
                    console.error('Google OAuth SDK not loaded');
                    alert('Google OAuth is not available. Please try again.');
                }
            } catch (error) {
                console.error('Error with Google OAuth:', error);
                alert('Error with Google OAuth. Please try again.');
            }
        }

        // Test function to check if Google OAuth is working
        function testGoogleOAuth() {
            console.log('Testing Google OAuth...');
            console.log('Google object:', typeof google);
            if (typeof google !== 'undefined') {
                console.log('Google accounts:', google.accounts);
                console.log('Google accounts.id:', google.accounts?.id);
            }
        }

        function checkUserAuthState() {
            const savedUser = localStorage.getItem('bharatBulletinUser');
            if (savedUser) {
                currentUser = JSON.parse(savedUser);
                updateUserInterface();
            }
        }

        function updateUserInterface() {
            const guestState = document.getElementById('guestState');
            const userState = document.getElementById('userState');
            const userName = document.getElementById('userName');
            const userEmail = document.getElementById('userEmail');
            const userAvatar = document.getElementById('userAvatar');
            const userAvatarIcon = document.getElementById('userAvatarIcon');

            if (currentUser) {
                // Show user state
                guestState.classList.add('hidden');
                userState.classList.remove('hidden');
                
                // Update user info
                userName.textContent = `Welcome, ${currentUser.given_name || currentUser.name}`;
                userEmail.textContent = currentUser.email;
                
                // Update avatar
                if (currentUser.picture) {
                    userAvatar.src = currentUser.picture;
                    userAvatar.classList.remove('hidden');
                    userAvatarIcon.classList.add('hidden');
                } else {
                    userAvatar.classList.add('hidden');
                    userAvatarIcon.classList.remove('hidden');
                }
            } else {
                // Show guest state
                guestState.classList.remove('hidden');
                userState.classList.add('hidden');
            }
        }

        function toggleUserMenu() {
            const userMenu = document.getElementById('userMenu');
            userMenu.classList.toggle('hidden');
        }

        function showUserProfile() {
            // Close user menu
            document.getElementById('userMenu').classList.add('hidden');
            
            // Show profile page or modal
            alert('Profile page coming soon!');
        }

        function showUserSettings() {
            // Close user menu
            document.getElementById('userMenu').classList.add('hidden');
            
            // Show settings page or modal
            alert('Settings page coming soon!');
        }

        function signOut() {
            // Clear user data
            currentUser = null;
            localStorage.removeItem('bharatBulletinUser');
            
            // Update UI
            updateUserInterface();
            
            // Close user menu
            document.getElementById('userMenu').classList.add('hidden');
            
            // Show sign out message
            showSignOutMessage();
        }

        function showWelcomeMessage() {
            // Create welcome notification
            const welcomeDiv = document.createElement('div');
            welcomeDiv.className = 'fixed top-4 right-4 bg-green-500 text-white px-6 py-3 rounded-lg shadow-lg z-50 transform transition-all duration-300 translate-x-full';
            welcomeDiv.innerHTML = `
                <div class="flex items-center space-x-3">
                    <div class="w-8 h-8 bg-white rounded-full flex items-center justify-center">
                        <i class="fas fa-check text-green-500 text-sm"></i>
                    </div>
                    <div>
                        <div class="font-semibold">Welcome to BharatBulletin!</div>
                        <div class="text-sm opacity-90">You're now signed in as ${currentUser.given_name || currentUser.name}</div>
                    </div>
                </div>
            `;
            
            document.body.appendChild(welcomeDiv);
            
            // Animate in
            setTimeout(() => {
                welcomeDiv.classList.remove('translate-x-full');
            }, 100);
            
            // Remove after 5 seconds
            setTimeout(() => {
                welcomeDiv.classList.add('translate-x-full');
                setTimeout(() => {
                    document.body.removeChild(welcomeDiv);
                }, 300);
            }, 5000);
        }

        function showSignOutMessage() {
            // Create sign out notification
            const signOutDiv = document.createElement('div');
            signOutDiv.className = 'fixed top-4 right-4 bg-blue-500 text-white px-6 py-3 rounded-lg shadow-lg z-50 transform transition-all duration-300 translate-x-full';
            signOutDiv.innerHTML = `
                <div class="flex items-center space-x-3">
                    <div class="w-8 h-8 bg-white rounded-full flex items-center justify-center">
                        <i class="fas fa-sign-out-alt text-blue-500 text-sm"></i>
                    </div>
                    <div>
                        <div class="font-semibold">Signed Out</div>
                        <div class="text-sm opacity-90">You have been successfully signed out</div>
                    </div>
                </div>
            `;
            
            document.body.appendChild(signOutDiv);
            
            // Animate in
            setTimeout(() => {
                signOutDiv.classList.remove('translate-x-full');
            }, 100);
            
            // Remove after 3 seconds
            setTimeout(() => {
                signOutDiv.classList.add('translate-x-full');
                setTimeout(() => {
                    document.body.removeChild(signOutDiv);
                }, 300);
            }, 3000);
        }

        // Dark mode functionality - FIXED
        function toggleDarkMode() {
            const html = document.documentElement;
            const isDark = html.classList.contains('dark');
            
            if (isDark) {
                html.classList.remove('dark');
                localStorage.setItem('darkMode', 'false');
            } else {
                html.classList.add('dark');
                localStorage.setItem('darkMode', 'true');
            }
        }

        function initializeDarkMode() {
            const savedMode = localStorage.getItem('darkMode');
            if (savedMode === 'true') {
                document.documentElement.classList.add('dark');
            }
        }

        // National News Data and Population
        function populateNationalNews() {
            const nationalNewsGrid = document.getElementById('nationalNewsGrid');
            const nationalNews = [
                {
                    title: 'Digital India Initiative Reaches New Milestone',
                    summary: 'Government announces major expansion of digital services across rural areas with new connectivity projects.',
                    time: '2 hours ago',
                    category: 'Technology',
                    icon: 'fas fa-laptop',
                    source: 'PIB India'
                },
                {
                    title: 'Monsoon Update: IMD Forecasts Normal Rainfall',
                    summary: 'Indian Meteorological Department predicts normal monsoon across most regions this season.',
                    time: '4 hours ago',
                    category: 'Weather',
                    icon: 'fas fa-cloud-rain',
                    source: 'IMD'
                },
                {
                    title: 'New Education Policy Implementation Progress',
                    summary: 'States report significant progress in implementing the National Education Policy 2020 reforms.',
                    time: '6 hours ago',
                    category: 'Education',
                    icon: 'fas fa-graduation-cap',
                    source: 'Ministry of Education'
                },
                {
                    title: 'Infrastructure Development: New Highway Projects',
                    summary: 'Government approves construction of 500km new highways to improve connectivity.',
                    time: '8 hours ago',
                    category: 'Infrastructure',
                    icon: 'fas fa-road',
                    source: 'NHAI'
                },
                {
                    title: 'Healthcare Milestone: Vaccination Drive Success',
                    summary: 'India achieves new milestone in vaccination coverage with focus on rural areas.',
                    time: '10 hours ago',
                    category: 'Healthcare',
                    icon: 'fas fa-syringe',
                    source: 'Ministry of Health'
                },
                {
                    title: 'Economic Growth: GDP Shows Positive Trend',
                    summary: 'Latest economic indicators show sustained growth across multiple sectors.',
                    time: '12 hours ago',
                    category: 'Economy',
                    icon: 'fas fa-chart-line',
                    source: 'RBI'
                }
            ];
            
            nationalNewsGrid.innerHTML = nationalNews.map(news => `
                <article class="bg-white dark:bg-gray-700 rounded-xl shadow-lg p-6 hover:shadow-xl transition-shadow">
                    <div class="flex items-start justify-between mb-4">
                        <div class="w-12 h-12 bg-blue-100 dark:bg-blue-900 rounded-full flex items-center justify-center">
                            <i class="${news.icon} text-blue-500 text-xl"></i>
                        </div>
                        <span class="bg-gray-100 dark:bg-gray-600 text-gray-600 dark:text-gray-300 px-2 py-1 rounded text-xs font-medium">
                            ${news.category}
                        </span>
                    </div>
                    <h3 class="font-bold text-gray-900 dark:text-white mb-2 line-clamp-2">${news.title}</h3>
                    <p class="text-gray-600 dark:text-gray-300 text-sm mb-4 line-clamp-3">${news.summary}</p>
                    <div class="flex items-center justify-between">
                        <div class="flex flex-col">
                            <span class="text-xs text-gray-500 dark:text-gray-400">${news.time}</span>
                            <span class="text-xs text-blue-500 font-medium">${news.source}</span>
                        </div>
                        <button class="text-blue-500 hover:text-blue-600 font-medium text-sm">
                            Read More →
                        </button>
                    </div>
                </article>
            `).join('');
        }

        // Page navigation
        function showPage(pageId) {
            // Hide all pages
            const pages = document.querySelectorAll('.page-content');
            pages.forEach(page => page.classList.add('hidden'));
            
            // Show selected page
            const targetPage = document.getElementById(pageId + 'Page');
            if (targetPage) {
                targetPage.classList.remove('hidden');
                currentPage = pageId;
                
                // Update navigation active state
                updateNavigation(pageId);
                
                // Scroll to top
                window.scrollTo(0, 0);
            }
        }

        function updateNavigation(activePageId) {
            const navLinks = document.querySelectorAll('.nav-link');
            navLinks.forEach(link => {
                link.classList.remove('text-primary-600', 'dark:text-primary-400', 'font-semibold');
                link.classList.add('text-gray-700', 'dark:text-gray-300');
            });
            
            // Find and highlight active link
            const activeLink = document.querySelector(`[onclick="showPage('${activePageId}')"]`);
            if (activeLink) {
                activeLink.classList.remove('text-gray-700', 'dark:text-gray-300');
                activeLink.classList.add('text-primary-600', 'dark:text-primary-400', 'font-semibold');
            }
        }

        // Mobile menu toggle
        function toggleMobileMenu() {
            const mobileMenu = document.getElementById('mobileMenu');
            mobileMenu.classList.toggle('hidden');
        }

        // Auth modal functions
        function openAuthModal() {
            document.getElementById('authModal').classList.remove('hidden');
        }

        function closeAuthModal() {
            document.getElementById('authModal').classList.add('hidden');
        }

        function showSignIn() {
            document.getElementById('signInForm').classList.remove('hidden');
            document.getElementById('signUpForm').classList.add('hidden');
            document.getElementById('signInTab').classList.add('bg-white', 'dark:bg-gray-600', 'text-primary-600', 'dark:text-primary-400', 'shadow-sm');
            document.getElementById('signInTab').classList.remove('text-gray-600', 'dark:text-gray-400');
            document.getElementById('signUpTab').classList.remove('bg-white', 'dark:bg-gray-600', 'text-primary-600', 'dark:text-primary-400', 'shadow-sm');
            document.getElementById('signUpTab').classList.add('text-gray-600', 'dark:text-gray-400');
        }

        function showSignUp() {
            document.getElementById('signUpForm').classList.remove('hidden');
            document.getElementById('signInForm').classList.add('hidden');
            document.getElementById('signUpTab').classList.add('bg-white', 'dark:bg-gray-600', 'text-primary-600', 'dark:text-primary-400', 'shadow-sm');
            document.getElementById('signUpTab').classList.remove('text-gray-600', 'dark:text-gray-400');
            document.getElementById('signInTab').classList.remove('bg-white', 'dark:bg-gray-600', 'text-primary-600', 'dark:text-primary-400', 'shadow-sm');
            document.getElementById('signInTab').classList.add('text-gray-600', 'dark:text-gray-400');
        }

        // Leaflet Map Integration
        let map = null;
        let mapMarkers = [];
        let currentMapLayer = 'events';

        function initMap() {
            // Initialize map centered on India
            map = L.map('communityMap').setView([20.5937, 78.9629], 5);
            
            // Add OpenStreetMap tiles
            L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
                attribution: '© OpenStreetMap contributors'
            }).addTo(map);

            // Add weather layer
            L.tileLayer('https://tile.openweathermap.org/map/precipitation_new/{z}/{x}/{y}.png?appid=YOUR_WEATHER_API_KEY', {
                attribution: '© OpenWeatherMap'
            }).addTo(map);

            // Add map controls
            map.addControl(new L.Control.Fullscreen());
            
            // Initialize with events layer
            showMapLayer('events');
        }

        function requestLocation() {
            const locationBtn = document.getElementById('locationBtn');
            const locationText = document.getElementById('locationText');
            
            if (!navigator.geolocation) {
                alert('Geolocation is not supported by this browser.');
                return;
            }
            
            locationBtn.innerHTML = '<i class="fas fa-spinner fa-spin mr-2"></i>Getting Location...';
            locationBtn.disabled = true;
            
            navigator.geolocation.getCurrentPosition(
                async (position) => {
                    userLocation = {
                        lat: position.coords.latitude,
                        lng: position.coords.longitude
                    };
                    
                    try {
                        const locationData = await getLocationDetailsFromLeaflet(userLocation.lat, userLocation.lng);
                        locationText.textContent = `📍 ${locationData.district}, ${locationData.state}`;
                        locationBtn.innerHTML = '<i class="fas fa-check mr-2"></i>Location Enabled';
                        locationBtn.classList.remove('bg-orange-500', 'hover:bg-orange-600');
                        locationBtn.classList.add('bg-green-500', 'hover:bg-green-600');
                        
                        // Update map to user location
                        map.setView([userLocation.lat, userLocation.lng], 12);
                        addUserLocationMarker(userLocation.lat, userLocation.lng);
                        
                        // Hide national news and show local news
                        document.getElementById('nationalNewsSection').classList.add('hidden');
                        showLocalNews(locationData);
                        
                        // Load local weather and events
                        loadLocalWeather(userLocation.lat, userLocation.lng);
                        loadLocalEvents(userLocation.lat, userLocation.lng);
                    } catch (error) {
                        console.error('Error getting location details:', error);
                        locationText.textContent = 'Location enabled - Loading local news...';
                        locationBtn.innerHTML = '<i class="fas fa-check mr-2"></i>Location Enabled';
                        document.getElementById('nationalNewsSection').classList.add('hidden');
                        showLocalNews({ district: 'Your Area', state: 'India' });
                    }
                },
                (error) => {
                    console.error('Error getting location:', error);
                    locationText.textContent = 'Unable to get location. Please try again.';
                    locationBtn.innerHTML = '<i class="fas fa-location-arrow mr-2"></i>Try Again';
                    locationBtn.disabled = false;
                }
            );
        }

        async function getLocationDetailsFromLeaflet(lat, lng) {
            // Using free Nominatim geocoding service
            try {
                const response = await fetch(`https://nominatim.openstreetmap.org/reverse?format=json&lat=${lat}&lon=${lng}&zoom=10&addressdetails=1`);
                const data = await response.json();
                
                if (data.address) {
                    return {
                        district: data.address.city || data.address.town || data.address.village || 'Your Area',
                        state: data.address.state || 'India',
                        fullAddress: data.display_name
                    };
                } else {
                    return {
                        district: 'Your Area',
                        state: 'India',
                        fullAddress: 'Location detected'
                    };
                }
            } catch (error) {
                console.error('Geocoding error:', error);
                return {
                    district: 'Your Area',
                    state: 'India',
                    fullAddress: 'Location detected'
                };
            }
        }

        function addUserLocationMarker(lat, lng) {
            // Add user location marker
            const userIcon = L.divIcon({
                className: 'user-location-marker',
                html: '<div class="w-6 h-6 bg-blue-500 rounded-full border-2 border-white shadow-lg flex items-center justify-center"><i class="fas fa-user text-white text-xs"></i></div>',
                iconSize: [24, 24],
                iconAnchor: [12, 12]
            });
            
            L.marker([lat, lng], { icon: userIcon })
                .addTo(map)
                .bindPopup('<b>Your Location</b><br>You are here!');
        }

        function showMapLayer(layerType) {
            currentMapLayer = layerType;
            
            // Update button states
            document.querySelectorAll('.map-layer-btn').forEach(btn => {
                btn.classList.remove('bg-primary-500', 'text-white');
                btn.classList.add('bg-gray-200', 'dark:bg-gray-700', 'text-gray-700', 'dark:text-gray-300');
            });
            
            event.target.classList.remove('bg-gray-200', 'dark:bg-gray-700', 'text-gray-700', 'dark:text-gray-300');
            event.target.classList.add('bg-primary-500', 'text-white');
            
            // Clear existing markers
            mapMarkers.forEach(marker => map.removeLayer(marker));
            mapMarkers = [];
            
            // Add markers based on layer type
            switch(layerType) {
                case 'events':
                    addEventMarkers();
                    break;
                case 'announcements':
                    addAnnouncementMarkers();
                    break;
                case 'weather':
                    addWeatherMarkers();
                    break;
                case 'all':
                    addEventMarkers();
                    addAnnouncementMarkers();
                    addWeatherMarkers();
                    break;
            }
        }

        function addEventMarkers() {
            const events = [
                { lat: 19.0760, lng: 72.8777, title: 'Mumbai Cultural Festival', description: 'Annual cultural celebration', category: 'cultural' },
                { lat: 28.6139, lng: 77.2090, title: 'Delhi Sports Tournament', description: 'Inter-community sports event', category: 'sports' },
                { lat: 12.9716, lng: 77.5946, title: 'Bangalore Tech Meet', description: 'Technology and innovation showcase', category: 'official' }
            ];
            
            events.forEach(event => {
                const icon = L.divIcon({
                    className: 'event-marker',
                    html: `<div class="w-8 h-8 bg-green-500 rounded-full border-2 border-white shadow-lg flex items-center justify-center"><i class="fas fa-calendar text-white text-sm"></i></div>`,
                    iconSize: [32, 32],
                    iconAnchor: [16, 16]
                });
                
                const marker = L.marker([event.lat, event.lng], { icon })
                    .addTo(map)
                    .bindPopup(`
                        <div class="p-2">
                            <h3 class="font-bold text-green-600">${event.title}</h3>
                            <p class="text-sm text-gray-600">${event.description}</p>
                            <span class="inline-block bg-green-100 text-green-800 text-xs px-2 py-1 rounded mt-2">${event.category}</span>
                        </div>
                    `);
                
                mapMarkers.push(marker);
            });
        }

        function addAnnouncementMarkers() {
            const announcements = [
                { lat: 19.0760, lng: 72.8777, title: 'Water Supply Alert', description: 'Scheduled maintenance tomorrow', category: 'urgent' },
                { lat: 28.6139, lng: 77.2090, title: 'Security Update', description: 'Enhanced security measures in place', category: 'general' },
                { lat: 12.9716, lng: 77.5946, title: 'Parking Guidelines', description: 'New parking allocation system', category: 'maintenance' }
            ];
            
            announcements.forEach(announcement => {
                const icon = L.divIcon({
                    className: 'announcement-marker',
                    html: `<div class="w-8 h-8 bg-orange-500 rounded-full border-2 border-white shadow-lg flex items-center justify-center"><i class="fas fa-bullhorn text-white text-sm"></i></div>`,
                    iconSize: [32, 32],
                    iconAnchor: [16, 16]
                });
                
                const marker = L.marker([announcement.lat, announcement.lng], { icon })
                    .addTo(map)
                    .bindPopup(`
                        <div class="p-2">
                            <h3 class="font-bold text-orange-600">${announcement.title}</h3>
                            <p class="text-sm text-gray-600">${announcement.description}</p>
                            <span class="inline-block bg-orange-100 text-orange-800 text-xs px-2 py-1 rounded mt-2">${announcement.category}</span>
                        </div>
                    `);
                
                mapMarkers.push(marker);
            });
        }

        function addWeatherMarkers() {
            const weatherStations = [
                { lat: 19.0760, lng: 72.8777, temp: '28°C', condition: 'Partly Cloudy', humidity: '65%' },
                { lat: 28.6139, lng: 77.2090, temp: '32°C', condition: 'Sunny', humidity: '45%' },
                { lat: 12.9716, lng: 77.5946, temp: '26°C', condition: 'Light Rain', humidity: '80%' }
            ];
            
            weatherStations.forEach(station => {
                const icon = L.divIcon({
                    className: 'weather-marker',
                    html: `<div class="w-8 h-8 bg-blue-500 rounded-full border-2 border-white shadow-lg flex items-center justify-center"><i class="fas fa-cloud text-white text-sm"></i></div>`,
                    iconSize: [32, 32],
                    iconAnchor: [16, 16]
                });
                
                const marker = L.marker([station.lat, station.lng], { icon })
                    .addTo(map)
                    .bindPopup(`
                        <div class="p-2">
                            <h3 class="font-bold text-blue-600">Weather Station</h3>
                            <p class="text-sm text-gray-600">Temperature: ${station.temp}</p>
                            <p class="text-sm text-gray-600">Condition: ${station.condition}</p>
                            <p class="text-sm text-gray-600">Humidity: ${station.humidity}</p>
                        </div>
                    `);
                
                mapMarkers.push(marker);
            });
        }

        async function loadLocalWeather(lat, lng) {
            // Simulate weather data loading
            console.log('Loading weather data for:', lat, lng);
            
            // Sample weather data (in real implementation, use OpenWeatherMap API)
            const weatherData = [
                {
                    location: 'Current Location',
                    temperature: '28°C',
                    condition: 'Partly Cloudy',
                    humidity: '65%',
                    windSpeed: '12 km/h',
                    icon: 'fas fa-cloud-sun',
                    color: 'blue'
                },
                {
                    location: 'Today',
                    temperature: '32°C',
                    condition: 'Sunny',
                    humidity: '45%',
                    windSpeed: '8 km/h',
                    icon: 'fas fa-sun',
                    color: 'yellow'
                },
                {
                    location: 'Tomorrow',
                    temperature: '26°C',
                    condition: 'Light Rain',
                    humidity: '80%',
                    windSpeed: '15 km/h',
                    icon: 'fas fa-cloud-rain',
                    color: 'gray'
                }
            ];
            
            populateWeatherWidgets(weatherData);
        }

        function populateWeatherWidgets(weatherData) {
            const weatherWidgets = document.getElementById('weatherWidgets');
            
            weatherWidgets.innerHTML = weatherData.map(weather => `
                <div class="bg-white dark:bg-gray-800 rounded-xl shadow-lg p-6 hover:shadow-xl transition-shadow">
                    <div class="flex items-center justify-between mb-4">
                        <div class="w-12 h-12 bg-${weather.color}-100 dark:bg-${weather.color}-900 rounded-full flex items-center justify-center">
                            <i class="${weather.icon} text-${weather.color}-500 text-xl"></i>
                        </div>
                        <span class="text-sm text-gray-500 dark:text-gray-400">${weather.location}</span>
                    </div>
                    <div class="text-center">
                        <div class="text-3xl font-bold text-gray-900 dark:text-white mb-2">${weather.temperature}</div>
                        <div class="text-gray-600 dark:text-gray-300 mb-4">${weather.condition}</div>
                        <div class="grid grid-cols-2 gap-4 text-sm">
                            <div>
                                <span class="text-gray-500 dark:text-gray-400">Humidity</span>
                                <div class="font-semibold text-gray-900 dark:text-white">${weather.humidity}</div>
                            </div>
                            <div>
                                <span class="text-gray-500 dark:text-gray-400">Wind</span>
                                <div class="font-semibold text-gray-900 dark:text-white">${weather.windSpeed}</div>
                            </div>
                        </div>
                    </div>
                </div>
            `).join('');
        }

        async function loadLocalEvents(lat, lng) {
            // Simulate local events loading
            console.log('Loading local events for:', lat, lng);
            // In a real implementation, you would call an events API here
        }

        function showLocalNews(locationData) {
            const localNewsSection = document.getElementById('localNewsSection');
            const localNewsSubtitle = document.getElementById('localNewsSubtitle');
            const localNewsGrid = document.getElementById('localNewsGrid');
            
            localNewsSubtitle.textContent = `Latest updates from ${locationData.district}, ${locationData.state}`;
            
            // Sample local news data based on location
            const localNews = [
                {
                    title: `${locationData.district} Metro Extension Project Approved`,
                    summary: 'New metro line to connect major residential areas with business districts.',
                    time: '2 hours ago',
                    category: 'Infrastructure',
                    icon: 'fas fa-subway'
                },
                {
                    title: `Local Festival Celebrations in ${locationData.state}`,
                    summary: 'Community comes together for traditional festival celebrations this weekend.',
                    time: '4 hours ago',
                    category: 'Culture',
                    icon: 'fas fa-calendar-alt'
                },
                {
                    title: 'New Healthcare Center Opens',
                    summary: 'State-of-the-art medical facility now serving the local community.',
                    time: '6 hours ago',
                    category: 'Healthcare',
                    icon: 'fas fa-hospital'
                },
                {
                    title: 'Traffic Updates & Road Closures',
                    summary: 'Important traffic diversions due to ongoing construction work.',
                    time: '8 hours ago',
                    category: 'Traffic',
                    icon: 'fas fa-road'
                },
                {
                    title: 'Local Business Spotlight',
                    summary: 'Supporting small businesses that make our community special.',
                    time: '12 hours ago',
                    category: 'Business',
                    icon: 'fas fa-store'
                },
                {
                    title: 'Weather Alert for This Week',
                    summary: 'Monsoon updates and weather forecast for the coming days.',
                    time: '1 day ago',
                    category: 'Weather',
                    icon: 'fas fa-cloud-rain'
                }
            ];
            
            localNewsGrid.innerHTML = localNews.map(news => `
                <article class="bg-white dark:bg-gray-700 rounded-xl shadow-lg p-6 hover:shadow-xl transition-shadow">
                    <div class="flex items-start justify-between mb-4">
                        <div class="w-12 h-12 bg-orange-100 dark:bg-orange-900 rounded-full flex items-center justify-center">
                            <i class="${news.icon} text-orange-500 text-xl"></i>
                        </div>
                        <span class="bg-gray-100 dark:bg-gray-600 text-gray-600 dark:text-gray-300 px-2 py-1 rounded text-xs font-medium">
                            ${news.category}
                        </span>
                    </div>
                    <h3 class="font-bold text-gray-900 dark:text-white mb-2 line-clamp-2">${news.title}</h3>
                    <p class="text-gray-600 dark:text-gray-300 text-sm mb-4 line-clamp-3">${news.summary}</p>
                    <div class="flex items-center justify-between">
                        <span class="text-xs text-gray-500 dark:text-gray-400">${news.time}</span>
                        <button class="text-orange-500 hover:text-orange-600 font-medium text-sm">
                            Read More →
                        </button>
                    </div>
                </article>
            `).join('');
            
            localNewsSection.classList.remove('hidden');
            localNewsSection.scrollIntoView({ behavior: 'smooth' });
        }

        // Load More Announcements Function
        function loadMoreAnnouncements() {
            const loadMoreBtn = document.getElementById('loadMoreAnnouncementsBtn');
            loadMoreBtn.innerHTML = '<i class="fas fa-spinner fa-spin mr-2"></i>Loading...';
            loadMoreBtn.disabled = true;
            
            // Simulate loading delay
            setTimeout(() => {
                announcementsDisplayed += 6;
                populateAnnouncements();
                
                if (announcementsDisplayed >= announcementsData.length) {
                    loadMoreBtn.style.display = 'none';
                } else {
                    loadMoreBtn.innerHTML = '<i class="fas fa-chevron-down mr-2"></i>Load More Announcements';
                    loadMoreBtn.disabled = false;
                }
            }, 1000);
        }

        // Announcement filter functionality
        document.addEventListener('DOMContentLoaded', function() {
            const filterButtons = document.querySelectorAll('.announcement-filter');
            
            filterButtons.forEach(button => {
                button.addEventListener('click', function() {
                    const filter = this.getAttribute('data-filter');
                    
                    // Update active button
                    filterButtons.forEach(btn => {
                        btn.classList.remove('active', 'bg-primary-500', 'text-white');
                        btn.classList.add('bg-gray-200', 'dark:bg-gray-700', 'text-gray-700', 'dark:text-gray-300');
                    });
                    this.classList.add('active', 'bg-primary-500', 'text-white');
                    this.classList.remove('bg-gray-200', 'dark:bg-gray-700', 'text-gray-700', 'dark:text-gray-300');
                    
                    // Filter announcements
                    filterAnnouncements(filter);
                });
            });
        });

        function filterAnnouncements(filter) {
            const announcementsGrid = document.getElementById('announcementsGrid');
            let filteredAnnouncements = [];
            
            if (filter === 'all') {
                filteredAnnouncements = announcementsData.slice(0, announcementsDisplayed);
            } else if (filter === 'nearby') {
                // Show location-based announcements if user has enabled location
                if (userLocation) {
                    filteredAnnouncements = announcementsData.filter(announcement => 
                        announcement.category === 'urgent' || announcement.category === 'maintenance'
                    ).slice(0, announcementsDisplayed);
                } else {
                    // Show message to enable location
                    announcementsGrid.innerHTML = `
                        <div class="col-span-full text-center py-12">
                            <div class="w-16 h-16 bg-orange-100 dark:bg-orange-900 rounded-full flex items-center justify-center mx-auto mb-4">
                                <i class="fas fa-map-marker-alt text-orange-500 text-2xl"></i>
                            </div>
                            <h3 class="text-xl font-semibold text-gray-900 dark:text-white mb-2">Enable Location</h3>
                            <p class="text-gray-600 dark:text-gray-300 mb-4">Enable location to see nearby announcements</p>
                            <button onclick="requestLocation()" class="bg-orange-500 hover:bg-orange-600 text-white px-6 py-2 rounded-lg font-medium transition-colors">
                                <i class="fas fa-location-arrow mr-2"></i>Enable Location
                            </button>
                        </div>
                    `;
                    return;
                }
            } else {
                filteredAnnouncements = announcementsData.filter(announcement => 
                    announcement.category === filter
                ).slice(0, announcementsDisplayed);
            }
            
            // Display filtered announcements
            announcementsGrid.innerHTML = filteredAnnouncements.map(announcement => `
                <article class="bg-white dark:bg-gray-800 rounded-xl shadow-lg p-6 hover:shadow-xl transition-shadow ${announcement.pinned ? 'border-l-4 border-red-500' : ''}">
                    <div class="flex items-start justify-between mb-4">
                        <div class="flex items-center space-x-2">
                            ${announcement.badge ? `<span class="${announcement.badgeColor} text-white px-2 py-1 rounded text-xs font-bold">${announcement.badge}</span>` : ''}
                            <span class="text-sm text-gray-500 dark:text-gray-400">${announcement.date}</span>
                        </div>
                        ${announcement.pinned ? '<i class="fas fa-thumbtack text-red-500"></i>' : ''}
                    </div>
                    <h3 class="font-bold text-gray-900 dark:text-white mb-3 text-lg">${announcement.title}</h3>
                    <p class="text-gray-600 dark:text-gray-300 mb-4">${announcement.content}</p>
                    <div class="flex items-center justify-between">
                        <span class="text-xs text-gray-500 dark:text-gray-400 capitalize">${announcement.category}</span>
                        <button class="text-primary-500 hover:text-primary-600 font-medium text-sm">
                            Read More →
                        </button>
                    </div>
                </article>
            `).join('');
        }

        // Event Calendar Functions
        function filterEventsByDate() {
            const selectedDate = document.getElementById('eventDatePicker').value;
            if (selectedDate) {
                const selected = new Date(selectedDate);
                filteredEvents = allEvents.filter(event => {
                    const eventDate = new Date(event.rawDate);
                    return eventDate.toDateString() === selected.toDateString();
                });
                displayFilteredEvents();
            }
        }

        function filterEventsByCategory() {
            const selectedCategory = document.getElementById('eventCategoryFilter').value;
            if (selectedCategory === 'all') {
                filteredEvents = [...allEvents];
            } else {
                filteredEvents = allEvents.filter(event => event.category === selectedCategory);
            }
            displayFilteredEvents();
        }

        function clearEventFilters() {
            document.getElementById('eventDatePicker').value = '';
            document.getElementById('eventCategoryFilter').value = 'all';
            filteredEvents = [...allEvents];
            displayFilteredEvents();
        }

        function displayFilteredEvents() {
            const eventsGrid = document.getElementById('eventsGrid');
            const noEventsMessage = document.getElementById('noEventsMessage');
            
            if (filteredEvents.length === 0) {
                eventsGrid.innerHTML = '';
                noEventsMessage.classList.remove('hidden');
            } else {
                noEventsMessage.classList.add('hidden');
                eventsGrid.innerHTML = filteredEvents.map(event => `
                    <article class="bg-white dark:bg-gray-800 rounded-xl shadow-lg p-6 hover:shadow-xl transition-shadow ${event.featured ? 'border-2 border-primary-200 dark:border-primary-800' : ''}">
                        <div class="flex items-start justify-between mb-4">
                            ${event.featured ? '<span class="bg-primary-500 text-white px-2 py-1 rounded text-xs font-bold">FEATURED</span>' : ''}
                            <span class="bg-${getCategoryColor(event.category)}-100 text-${getCategoryColor(event.category)}-800 dark:bg-${getCategoryColor(event.category)}-900 dark:text-${getCategoryColor(event.category)}-200 px-2 py-1 rounded text-xs font-medium capitalize">${event.category}</span>
                        </div>
                        <h3 class="font-bold text-gray-900 dark:text-white mb-3 text-lg">${event.title}</h3>
                        <div class="space-y-2 text-sm text-gray-600 dark:text-gray-300 mb-4">
                            <div class="flex items-center">
                                <i class="fas fa-calendar-day w-4 mr-2"></i>
                                <span>${event.date}</span>
                            </div>
                            <div class="flex items-center">
                                <i class="fas fa-clock w-4 mr-2"></i>
                                <span>${event.time}</span>
                            </div>
                            <div class="flex items-center">
                                <i class="fas fa-map-marker-alt w-4 mr-2"></i>
                                <span>${event.location}</span>
                            </div>
                        </div>
                        <p class="text-gray-600 dark:text-gray-300 text-sm mb-4">${event.description}</p>
                        <div class="flex items-center justify-between">
                            <span class="text-xs text-gray-500 dark:text-gray-400">${event.rsvp} people interested</span>
                            <button class="bg-primary-500 hover:bg-primary-600 text-white px-4 py-2 rounded-lg font-medium transition-colors text-sm">
                                <i class="fas fa-check mr-1"></i>RSVP
                            </button>
                        </div>
                    </article>
                `).join('');
            }
        }

        // Post Ad Modal Functions
        function openPostAdModal() {
            document.getElementById('postAdModal').classList.remove('hidden');
        }

        function closePostAdModal() {
            document.getElementById('postAdModal').classList.add('hidden');
            document.getElementById('postAdForm').reset();
        }

        // Handle Post Ad Form Submission
        document.getElementById('postAdForm').addEventListener('submit', function(e) {
            e.preventDefault();
            
            const adType = document.querySelector('input[name="adType"]:checked')?.value;
            const adData = {
                type: adType,
                category: document.getElementById('adCategory').value,
                title: document.getElementById('adTitle').value,
                description: document.getElementById('adDescription').value,
                price: document.getElementById('adPrice').value || 'Contact for price',
                contactName: document.getElementById('adContactName').value,
                contactPhone: document.getElementById('adContactPhone').value,
                location: document.getElementById('adLocation').value,
                duration: document.querySelector('input[name="adDuration"]:checked')?.value || '30'
            };
            
            // Add to marketplace
            marketplaceData.unshift({
                category: adData.type,
                title: adData.title,
                description: adData.description,
                price: adData.price,
                contact: `${adData.location} - ${adData.contactPhone}`,
                daysLeft: parseInt(adData.duration),
                icon: 'fas fa-tag',
                featured: false
            });
            
            alert('🎉 Ad posted successfully! It will be reviewed and published within 24 hours.');
            closePostAdModal();
            
            if (currentPage === 'marketplace') {
                populateMarketplace();
            }
        });

        // Populate content for different pages
        function populateContent() {
            populateAnnouncements();
            populateEvents();
            populateMarketplace();
            populateContacts();
        }

        function populateAnnouncements() {
            announcementsData = [
                {
                    category: 'urgent',
                    title: 'Water Supply Maintenance',
                    content: 'Scheduled maintenance work will affect water supply tomorrow from 10 AM to 2 PM. Please store water in advance.',
                    date: 'Dec 20, 2024',
                    badge: 'URGENT',
                    badgeColor: 'bg-red-500',
                    pinned: true
                },
                {
                    category: 'general',
                    title: 'Holiday Decoration Contest',
                    content: 'Join our annual holiday decoration contest! Prizes for best decorated balcony and entrance. Registration deadline: Dec 25th.',
                    date: 'Dec 19, 2024',
                    badge: 'NEW',
                    badgeColor: 'bg-blue-500',
                    pinned: false
                },
                {
                    category: 'maintenance',
                    title: 'Parking Guidelines Updated',
                    content: 'New parking allocation system is now in effect. Please check your assigned spots and follow the new guidelines.',
                    date: 'Dec 18, 2024',
                    badge: 'UPDATE',
                    badgeColor: 'bg-green-500',
                    pinned: false
                },
                {
                    category: 'general',
                    title: 'Monthly Maintenance Fee',
                    content: 'Reminder: Monthly maintenance fees are due by the 25th of each month. Late payments will incur additional charges.',
                    date: 'Dec 17, 2024',
                    badge: '',
                    badgeColor: '',
                    pinned: false
                },
                {
                    category: 'events',
                    title: 'New Year Celebration Planning',
                    content: 'Community meeting to discuss New Year celebration arrangements. All residents are welcome to participate.',
                    date: 'Dec 16, 2024',
                    badge: 'EVENT',
                    badgeColor: 'bg-purple-500',
                    pinned: false
                },
                {
                    category: 'maintenance',
                    title: 'Elevator Maintenance Schedule',
                    content: 'Regular maintenance of elevators will be conducted every Sunday from 8 AM to 10 AM.',
                    date: 'Dec 15, 2024',
                    badge: 'MAINTENANCE',
                    badgeColor: 'bg-orange-500',
                    pinned: false
                },
                // Additional announcements for load more functionality
                {
                    category: 'general',
                    title: 'Community Garden Initiative',
                    content: 'New community garden project starting next month. Volunteers needed for setup and maintenance.',
                    date: 'Dec 14, 2024',
                    badge: 'NEW',
                    badgeColor: 'bg-blue-500',
                    pinned: false
                },
                {
                    category: 'urgent',
                    title: 'Security Alert',
                    content: 'Increased security measures in place. Please carry ID cards and inform guests about visitor protocols.',
                    date: 'Dec 13, 2024',
                    badge: 'URGENT',
                    badgeColor: 'bg-red-500',
                    pinned: false
                },
                {
                    category: 'maintenance',
                    title: 'Internet Connectivity Upgrade',
                    content: 'Fiber optic internet upgrade scheduled for next week. Temporary disruptions expected.',
                    date: 'Dec 12, 2024',
                    badge: 'UPDATE',
                    badgeColor: 'bg-green-500',
                    pinned: false
                },
                {
                    category: 'events',
                    title: 'Annual General Meeting',
                    content: 'Annual General Meeting scheduled for January 15th. All residents must attend.',
                    date: 'Dec 11, 2024',
                    badge: 'IMPORTANT',
                    badgeColor: 'bg-purple-500',
                    pinned: false
                },
                {
                    category: 'general',
                    title: 'Waste Management Guidelines',
                    content: 'New waste segregation rules effective from next month. Please follow color-coded bins.',
                    date: 'Dec 10, 2024',
                    badge: 'UPDATE',
                    badgeColor: 'bg-green-500',
                    pinned: false
                },
                {
                    category: 'maintenance',
                    title: 'CCTV System Upgrade',
                    content: 'Enhanced security camera system installation in progress. Better coverage and quality.',
                    date: 'Dec 9, 2024',
                    badge: 'UPGRADE',
                    badgeColor: 'bg-blue-500',
                    pinned: false
                }
            ];

            const announcementsGrid = document.getElementById('announcementsGrid');
            const displayedAnnouncements = announcementsData.slice(0, announcementsDisplayed);

            announcementsGrid.innerHTML = displayedAnnouncements.map(announcement => `
                <article class="bg-white dark:bg-gray-800 rounded-xl shadow-lg p-6 hover:shadow-xl transition-shadow ${announcement.pinned ? 'border-l-4 border-red-500' : ''}">
                    <div class="flex items-start justify-between mb-4">
                        <div class="flex items-center space-x-2">
                            ${announcement.badge ? `<span class="${announcement.badgeColor} text-white px-2 py-1 rounded text-xs font-bold">${announcement.badge}</span>` : ''}
                            <span class="text-sm text-gray-500 dark:text-gray-400">${announcement.date}</span>
                        </div>
                        ${announcement.pinned ? '<i class="fas fa-thumbtack text-red-500"></i>' : ''}
                    </div>
                    <h3 class="font-bold text-gray-900 dark:text-white mb-3 text-lg">${announcement.title}</h3>
                    <p class="text-gray-600 dark:text-gray-300 mb-4">${announcement.content}</p>
                    <div class="flex items-center justify-between">
                        <span class="text-xs text-gray-500 dark:text-gray-400 capitalize">${announcement.category}</span>
                        <button class="text-primary-500 hover:text-primary-600 font-medium text-sm">
                            Read More →
                        </button>
                    </div>
                </article>
            `).join('');

            // Hide load more button if all announcements are displayed
            const loadMoreBtn = document.getElementById('loadMoreAnnouncementsBtn');
            if (announcementsDisplayed >= announcementsData.length) {
                loadMoreBtn.style.display = 'none';
            } else {
                loadMoreBtn.style.display = 'block';
            }
        }

        function populateEvents() {
            // Generate events for next 6 months
            const today = new Date();
            const events = [];
            
            // Helper function to add months to date
            function addMonths(date, months) {
                const result = new Date(date);
                result.setMonth(result.getMonth() + months);
                return result;
            }

            // Generate events for next 6 months
            for (let month = 0; month < 6; month++) {
                const currentMonth = addMonths(today, month);
                const monthName = currentMonth.toLocaleString('default', { month: 'long' });
                const year = currentMonth.getFullYear();
                
                // Cultural events
                events.push({
                    category: 'cultural',
                    title: `${monthName} Cultural Night`,
                    description: `Monthly cultural celebration featuring local artists, music, and traditional performances.`,
                    date: `${monthName} ${15 + month}, ${year}`,
                    rawDate: new Date(year, currentMonth.getMonth(), 15 + month).toISOString().split('T')[0],
                    time: '7:00 PM - 10:00 PM',
                    location: 'Community Hall',
                    featured: month === 0,
                    rsvp: Math.floor(Math.random() * 50) + 20
                });

                // Sports events
                events.push({
                    category: 'sports',
                    title: `${monthName} Sports Tournament`,
                    description: `Inter-building sports competition including cricket, badminton, and table tennis.`,
                    date: `${monthName} ${8 + month}, ${year}`,
                    rawDate: new Date(year, currentMonth.getMonth(), 8 + month).toISOString().split('T')[0],
                    time: '9:00 AM - 5:00 PM',
                    location: 'Sports Complex',
                    featured: false,
                    rsvp: Math.floor(Math.random() * 40) + 15
                });

                // Recreational events
                events.push({
                    category: 'recreational',
                    title: `${monthName} Yoga & Wellness`,
                    description: `Weekly yoga sessions and wellness workshops for all age groups.`,
                    date: `Every Saturday in ${monthName}`,
                    rawDate: new Date(year, currentMonth.getMonth(), 7).toISOString().split('T')[0],
                    time: '7:00 AM - 8:30 AM',
                    location: 'Garden Area',
                    featured: false,
                    rsvp: Math.floor(Math.random() * 25) + 10
                });

                // Official events
                if (month % 2 === 0) {
                    events.push({
                        category: 'official',
                        title: `${monthName} Society Meeting`,
                        description: `Bi-monthly society meeting to discuss community matters and upcoming projects.`,
                        date: `${monthName} ${5 + month}, ${year}`,
                        rawDate: new Date(year, currentMonth.getMonth(), 5 + month).toISOString().split('T')[0],
                        time: '6:00 PM - 8:00 PM',
                        location: 'Conference Room',
                        featured: false,
                        rsvp: Math.floor(Math.random() * 15) + 5
                    });
                }
            }

            // Add special events
            events.push({
                category: 'cultural',
                title: 'New Year Celebration 2025',
                description: 'Grand New Year celebration with live music, dance performances, and fireworks!',
                date: 'December 31, 2024',
                rawDate: '2024-12-31',
                time: '8:00 PM - 12:30 AM',
                location: 'Community Hall',
                featured: true,
                rsvp: 85
            });

            events.push({
                category: 'cultural',
                title: 'Republic Day Celebration',
                description: 'Celebrate Republic Day with flag hoisting, cultural programs, and refreshments.',
                date: 'January 26, 2025',
                rawDate: '2025-01-26',
                time: '8:00 AM - 11:00 AM',
                location: 'Main Entrance',
                featured: true,
                rsvp: 120
            });

            allEvents = events.sort((a, b) => new Date(a.rawDate) - new Date(b.rawDate));
            filteredEvents = [...allEvents];
            displayFilteredEvents();
        }

        function populateMarketplace() {
            marketplaceData = [
                // Electronics
                {
                    category: 'sale',
                    title: 'iPhone 13 Pro - Excellent Condition',
                    description: '128GB, Space Gray, with original box and accessories. Barely used for 6 months.',
                    price: '₹65,000',
                    contact: 'Apt 204 - 9876543210',
                    daysLeft: 15,
                    icon: 'fas fa-mobile-alt',
                    featured: true
                },
                {
                    category: 'sale',
                    title: 'Gaming Laptop - ASUS ROG',
                    description: 'RTX 3060, 16GB RAM, 512GB SSD. Perfect for gaming and work. 1 year warranty left.',
                    price: '₹85,000',
                    contact: 'Apt 105 - 9876543211',
                    daysLeft: 8,
                    icon: 'fas fa-laptop',
                    featured: false
                },
                {
                    category: 'sale',
                    title: '55" Smart TV - Samsung',
                    description: '4K UHD, HDR support, barely used. Moving out sale. Original price ₹55,000.',
                    price: '₹35,000',
                    contact: 'Apt 301 - 9876543212',
                    daysLeft: 5,
                    icon: 'fas fa-tv',
                    featured: false
                },
                
                // Furniture
                {
                    category: 'sale',
                    title: 'Dining Table Set - 6 Seater',
                    description: 'Solid wood dining table with 6 chairs. Excellent condition, well maintained.',
                    price: '₹25,000',
                    contact: 'Apt 502 - 9876543213',
                    daysLeft: 12,
                    icon: 'fas fa-chair',
                    featured: false
                },
                {
                    category: 'sale',
                    title: 'L-Shaped Sofa Set',
                    description: 'Comfortable 7-seater L-shaped sofa in brown leather. Perfect for large families.',
                    price: '₹45,000',
                    contact: 'Apt 203 - 9876543214',
                    daysLeft: 20,
                    icon: 'fas fa-couch',
                    featured: false
                },
                {
                    category: 'sale',
                    title: 'Queen Size Bed with Mattress',
                    description: 'Wooden bed frame with premium memory foam mattress. 2 years old.',
                    price: '₹18,000',
                    contact: 'Apt 401 - 9876543215',
                    daysLeft: 7,
                    icon: 'fas fa-bed',
                    featured: false
                },

                // Vehicles
                {
                    category: 'sale',
                    title: 'Honda City 2019 - Petrol',
                    description: 'Well maintained, single owner, full service history. 45,000 km driven.',
                    price: '₹9,50,000',
                    contact: 'Apt 106 - 9876543216',
                    daysLeft: 25,
                    icon: 'fas fa-car',
                    featured: true
                },
                {
                    category: 'sale',
                    title: 'Royal Enfield Classic 350',
                    description: '2020 model, excellent condition, all papers clear. Genuine reason for sale.',
                    price: '₹1,35,000',
                    contact: 'Apt 307 - 9876543217',
                    daysLeft: 18,
                    icon: 'fas fa-motorcycle',
                    featured: false
                },

                // Rental Items
                {
                    category: 'rent',
                    title: 'Covered Parking Space',
                    description: 'Secure covered parking in Block A basement. Available immediately.',
                    price: '₹2,500/month',
                    contact: 'Apt 105 - 9876543218',
                    daysLeft: 30,
                    icon: 'fas fa-car',
                    featured: false
                },
                {
                    category: 'rent',
                    title: '2BHK Furnished Apartment',
                    description: 'Fully furnished 2BHK with all amenities. Family preferred. No pets.',
                    price: '₹25,000/month',
                    contact: 'Apt 504 - 9876543219',
                    daysLeft: 22,
                    icon: 'fas fa-home',
                    featured: true
                },

                // Services
                {
                    category: 'services',
                    title: 'Home Cleaning Service',
                    description: 'Professional cleaning service. Weekly/monthly packages available. Experienced staff.',
                    price: '₹800/visit',
                    contact: 'Apt 203 - 9876543220',
                    daysLeft: 45,
                    icon: 'fas fa-broom',
                    featured: false
                },
                {
                    category: 'services',
                    title: 'Math & Science Tuition',
                    description: 'Experienced teacher for classes 8-12. CBSE/ICSE boards. Home tuition available.',
                    price: '₹1,500/month',
                    contact: 'Apt 402 - 9876543221',
                    daysLeft: 60,
                    icon: 'fas fa-book',
                    featured: false
                },
                {
                    category: 'services',
                    title: 'AC Repair & Maintenance',
                    description: 'Quick and reliable AC repair service. All brands. 24/7 emergency service.',
                    price: '₹300/visit',
                    contact: 'Apt 108 - 9876543222',
                    daysLeft: 40,
                    icon: 'fas fa-tools',
                    featured: false
                },

                // Wanted Items
                {
                    category: 'wanted',
                    title: 'Looking for Study Table',
                    description: 'Need a good condition study table for kids. Preferably with storage.',
                    price: 'Up to ₹5,000',
                    contact: 'Apt 301 - 9876543223',
                    daysLeft: 15,
                    icon: 'fas fa-desk',
                    featured: false
                },
                {
                    category: 'wanted',
                    title: 'Wanted: Bicycle for Adult',
                    description: 'Looking for adult bicycle in good condition. Gear cycle preferred.',
                    price: 'Up to ₹8,000',
                    contact: 'Apt 205 - 9876543224',
                    daysLeft: 10,
                    icon: 'fas fa-bicycle',
                    featured: false
                },

                // Free Items
                {
                    category: 'free',
                    title: 'Free Indoor Plants',
                    description: 'Various indoor plants with pots. Good for beginners. Pick up only.',
                    price: 'Free',
                    contact: 'Apt 502 - 9876543225',
                    daysLeft: 5,
                    icon: 'fas fa-seedling',
                    featured: false
                },
                {
                    category: 'free',
                    title: 'Old Newspapers & Magazines',
                    description: 'Collection of newspapers and magazines. Good for craft projects.',
                    price: 'Free',
                    contact: 'Apt 103 - 9876543226',
                    daysLeft: 3,
                    icon: 'fas fa-newspaper',
                    featured: false
                },

                // More Electronics
                {
                    category: 'sale',
                    title: 'Washing Machine - LG 7kg',
                    description: 'Front load washing machine, 3 years old. Excellent working condition.',
                    price: '₹22,000',
                    contact: 'Apt 406 - 9876543227',
                    daysLeft: 14,
                    icon: 'fas fa-tshirt',
                    featured: false
                },
                {
                    category: 'sale',
                    title: 'Refrigerator - Samsung 265L',
                    description: 'Double door refrigerator, 4 years old. Energy efficient, good condition.',
                    price: '₹18,000',
                    contact: 'Apt 207 - 9876543228',
                    daysLeft: 11,
                    icon: 'fas fa-snowflake',
                    featured: false
                },

                // Books & Education
                {
                    category: 'sale',
                    title: 'CBSE Class 12 Books Set',
                    description: 'Complete set of CBSE class 12 books. Science stream. Excellent condition.',
                    price: '₹2,500',
                    contact: 'Apt 305 - 9876543229',
                    daysLeft: 9,
                    icon: 'fas fa-book',
                    featured: false
                }
            ];

            displayMarketplaceItems(marketplaceData);
        }

        function displayMarketplaceItems(items) {
            const marketplaceGrid = document.getElementById('marketplaceGrid');
            marketplaceGrid.innerHTML = items.map(item => `
                <article class="bg-white dark:bg-gray-800 rounded-xl shadow-lg p-6 hover:shadow-xl transition-shadow ${item.featured ? 'border-2 border-orange-200 dark:border-orange-800' : ''}">
                    <div class="flex items-start justify-between mb-4">
                        <span class="bg-${getCategoryColorMarketplace(item.category)}-500 text-white px-2 py-1 rounded text-xs font-bold">${item.category.toUpperCase()}</span>
                        <span class="text-xs text-gray-500 dark:text-gray-400">${item.daysLeft} days left</span>
                    </div>
                    <div class="flex items-start space-x-4">
                        <div class="w-16 h-16 bg-gray-200 dark:bg-gray-600 rounded-lg flex items-center justify-center flex-shrink-0">
                            <i class="${item.icon} text-gray-500 text-xl"></i>
                        </div>
                        <div class="flex-1">
                            <h3 class="font-bold text-gray-900 dark:text-white mb-2 line-clamp-2">${item.title}</h3>
                            <p class="text-primary-600 dark:text-primary-400 font-bold text-lg mb-2">${item.price}</p>
                            <p class="text-gray-600 dark:text-gray-300 text-sm mb-3 line-clamp-2">${item.description}</p>
                            <div class="flex items-center text-sm text-gray-500 dark:text-gray-400">
                                <i class="fas fa-user mr-1"></i>
                                <span>${item.contact}</span>
                            </div>
                        </div>
                    </div>
                    <div class="mt-4 pt-4 border-t border-gray-200 dark:border-gray-600">
                        <button class="w-full bg-primary-500 hover:bg-primary-600 text-white py-2 rounded-lg font-medium transition-colors text-sm">
                            <i class="fas fa-phone mr-2"></i>Contact Seller
                        </button>
                    </div>
                </article>
            `).join('');
        }

        function populateContacts() {
            const contactsGrid = document.getElementById('contactsGrid');
            const contactCategories = [
                {
                    title: 'Society Management',
                    icon: 'fas fa-building',
                    iconColor: 'text-primary-500',
                    bgColor: 'bg-primary-100 dark:bg-primary-900',
                    contacts: [
                        { name: 'Mr. Rajesh Kumar', role: 'Society Manager', phone: '+91 98765 43200', email: 'manager@community.com' },
                        { name: 'Ms. Priya Sharma', role: 'Assistant Manager', phone: '+91 98765 43201', email: 'assistant@community.com' }
                    ]
                },
                {
                    title: 'Security',
                    icon: 'fas fa-shield-alt',
                    iconColor: 'text-green-500',
                    bgColor: 'bg-green-100 dark:bg-green-900',
                    contacts: [
                        { name: 'Mr. Suresh Singh', role: 'Security Supervisor', phone: '+91 98765 43202', email: 'security@community.com' },
                        { name: 'Gate Security', role: '24/7 Available', phone: '+91 98765 43203', email: '' }
                    ]
                },
                {
                    title: 'Maintenance Services',
                    icon: 'fas fa-tools',
                    iconColor: 'text-orange-500',
                    bgColor: 'bg-orange-100 dark:bg-orange-900',
                    contacts: [
                        { name: 'Ravi Electricals', role: 'Electrician', phone: '+91 98765 43204', email: 'ravi.electric@gmail.com' },
                        { name: 'Quick Fix Services', role: 'Plumber', phone: '+91 98765 43205', email: 'quickfix@gmail.com' },
                        { name: 'Green Thumb', role: 'Gardener', phone: '+91 98765 43206', email: 'garden@community.com' }
                    ]
                },
                {
                    title: 'Healthcare',
                    icon: 'fas fa-hospital',
                    iconColor: 'text-red-500',
                    bgColor: 'bg-red-100 dark:bg-red-900',
                    contacts: [
                        { name: 'City Hospital', role: 'Emergency Care', phone: '+91 98765 43207', email: 'emergency@cityhospital.com' },
                        { name: 'Dr. Amit Patel', role: 'Family Doctor', phone: '+91 98765 43208', email: 'dr.amit@clinic.com' }
                    ]
                },
                {
                    title: 'Utilities',
                    icon: 'fas fa-bolt',
                    iconColor: 'text-yellow-500',
                    bgColor: 'bg-yellow-100 dark:bg-yellow-900',
                    contacts: [
                        { name: 'Power Grid Corp', role: 'Electricity Board', phone: '+91 98765 43209', email: 'complaints@powergrid.com' },
                        { name: 'Water Department', role: 'Water Supply', phone: '+91 98765 43210', email: 'water@municipal.gov' }
                    ]
                },
                {
                    title: 'Local Services',
                    icon: 'fas fa-store',
                    iconColor: 'text-purple-500',
                    bgColor: 'bg-purple-100 dark:bg-purple-900',
                    contacts: [
                        { name: 'Fresh Mart', role: 'Grocery Store', phone: '+91 98765 43211', email: 'orders@freshmart.com' },
                        { name: 'Speedy Delivery', role: 'Courier Service', phone: '+91 98765 43212', email: 'pickup@speedydelivery.com' }
                    ]
                }
            ];

            contactsGrid.innerHTML = contactCategories.map(category => `
                <div class="bg-white dark:bg-gray-800 rounded-xl shadow-lg p-6">
                    <div class="text-center mb-6">
                        <div class="w-12 h-12 ${category.bgColor} rounded-full flex items-center justify-center mx-auto mb-3">
                            <i class="${category.icon} ${category.iconColor} text-xl"></i>
                        </div>
                        <h3 class="font-bold text-gray-900 dark:text-white text-lg">${category.title}</h3>
                    </div>
                    <div class="space-y-4">
                        ${category.contacts.map(contact => `
                            <div class="text-center p-3 bg-gray-50 dark:bg-gray-700 rounded-lg">
                                <p class="font-medium text-gray-900 dark:text-white">${contact.name}</p>
                                <p class="text-sm text-gray-600 dark:text-gray-300 mb-2">${contact.role}</p>
                                <a href="tel:${contact.phone}" class="text-primary-500 hover:text-primary-600 text-sm font-medium block mb-1">
                                    <i class="fas fa-phone mr-1"></i>${contact.phone}
                                </a>
                                ${contact.email ? `<a href="mailto:${contact.email}" class="text-primary-500 hover:text-primary-600 text-sm">
                                    <i class="fas fa-envelope mr-1"></i>${contact.email}
                                </a>` : ''}
                            </div>
                        `).join('')}
                    </div>
                </div>
            `).join('');
        }

        // Helper functions
        function getCategoryColor(category) {
            const colors = {
                'cultural': 'orange',
                'recreational': 'green',
                'official': 'purple',
                'sports': 'blue'
            };
            return colors[category] || 'gray';
        }

        function getCategoryColorMarketplace(category) {
            const colors = {
                'sale': 'green',
                'rent': 'blue',
                'wanted': 'orange',
                'free': 'purple',
                'services': 'indigo'
            };
            return colors[category] || 'gray';
        }

        // Filter functionality
        document.addEventListener('click', function(e) {
            if (e.target.classList.contains('announcement-filter')) {
                handleAnnouncementFilter(e.target);
            }
            if (e.target.classList.contains('event-filter')) {
                handleEventFilter(e.target);
            }
            if (e.target.classList.contains('marketplace-filter')) {
                handleMarketplaceFilter(e.target);
            }
        });

        function handleAnnouncementFilter(button) {
            // Update active state
            document.querySelectorAll('.announcement-filter').forEach(btn => {
                btn.classList.remove('active', 'bg-primary-500', 'text-white');
                btn.classList.add('bg-gray-200', 'dark:bg-gray-700', 'text-gray-700', 'dark:text-gray-300');
            });
            button.classList.add('active', 'bg-primary-500', 'text-white');
            button.classList.remove('bg-gray-200', 'dark:bg-gray-700', 'text-gray-700', 'dark:text-gray-300');
            
            // Filter announcements
            const filter = button.dataset.filter;
            let filteredAnnouncements = announcementsData;
            
            if (filter !== 'all') {
                filteredAnnouncements = announcementsData.filter(announcement => announcement.category === filter);
            }
            
            const announcementsGrid = document.getElementById('announcementsGrid');
            const displayedAnnouncements = filteredAnnouncements.slice(0, announcementsDisplayed);
            
            announcementsGrid.innerHTML = displayedAnnouncements.map(announcement => `
                <article class="bg-white dark:bg-gray-800 rounded-xl shadow-lg p-6 hover:shadow-xl transition-shadow ${announcement.pinned ? 'border-l-4 border-red-500' : ''}">
                    <div class="flex items-start justify-between mb-4">
                        <div class="flex items-center space-x-2">
                            ${announcement.badge ? `<span class="${announcement.badgeColor} text-white px-2 py-1 rounded text-xs font-bold">${announcement.badge}</span>` : ''}
                            <span class="text-sm text-gray-500 dark:text-gray-400">${announcement.date}</span>
                        </div>
                        ${announcement.pinned ? '<i class="fas fa-thumbtack text-red-500"></i>' : ''}
                    </div>
                    <h3 class="font-bold text-gray-900 dark:text-white mb-3 text-lg">${announcement.title}</h3>
                    <p class="text-gray-600 dark:text-gray-300 mb-4">${announcement.content}</p>
                    <div class="flex items-center justify-between">
                        <span class="text-xs text-gray-500 dark:text-gray-400 capitalize">${announcement.category}</span>
                        <button class="text-primary-500 hover:text-primary-600 font-medium text-sm">
                            Read More →
                        </button>
                    </div>
                </article>
            `).join('');
        }

        function handleEventFilter(button) {
            // Update active state
            document.querySelectorAll('.event-filter').forEach(btn => {
                btn.classList.remove('active', 'bg-primary-500', 'text-white');
                btn.classList.add('bg-gray-200', 'dark:bg-gray-700', 'text-gray-700', 'dark:text-gray-300');
            });
            button.classList.add('active', 'bg-primary-500', 'text-white');
            button.classList.remove('bg-gray-200', 'dark:bg-gray-700', 'text-gray-700', 'dark:text-gray-300');
            
            // Filter events
            const filter = button.dataset.filter;
            if (filter === 'all') {
                filteredEvents = [...allEvents];
            } else {
                filteredEvents = allEvents.filter(event => event.category === filter);
            }
            displayFilteredEvents();
        }

        function handleMarketplaceFilter(button) {
            // Update active state
            document.querySelectorAll('.marketplace-filter').forEach(btn => {
                btn.classList.remove('active', 'bg-primary-500', 'text-white');
                btn.classList.add('bg-gray-200', 'dark:bg-gray-700', 'text-gray-700', 'dark:text-gray-300');
            });
            button.classList.add('active', 'bg-primary-500', 'text-white');
            button.classList.remove('bg-gray-200', 'dark:bg-gray-700', 'text-gray-700', 'dark:text-gray-300');
            
            // Filter marketplace items
            const filter = button.dataset.filter;
            let filteredItems = marketplaceData;
            
            if (filter !== 'all') {
                filteredItems = marketplaceData.filter(item => item.category === filter);
            }
            
            displayMarketplaceItems(filteredItems);
        }

        // Close modal when clicking outside
        document.getElementById('authModal').addEventListener('click', function(e) {
            if (e.target === this) {
                closeAuthModal();
            }
        });

        // Close user menu when clicking outside
        document.addEventListener('click', function(e) {
            const userMenu = document.getElementById('userMenu');
            const userMenuButton = document.querySelector('[onclick="toggleUserMenu()"]');
            
            if (userMenu && !userMenu.contains(e.target) && !userMenuButton.contains(e.target)) {
                userMenu.classList.add('hidden');
            }
        });

        document.getElementById('postAdModal').addEventListener('click', function(e) {
            if (e.target === this) {
                closePostAdModal();
            }
        });

        // Smooth scrolling for navigation links
        document.querySelectorAll('a[href^="#"]').forEach(anchor => {
            anchor.addEventListener('click', function (e) {
                e.preventDefault();
                const target = document.querySelector(this.getAttribute('href'));
                if (target) {
                    target.scrollIntoView({
                        behavior: 'smooth',
                        block: 'start'
                    });
                }
            });
        });
    </script>
</body>
</html>
